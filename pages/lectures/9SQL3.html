<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advanced SQL: Performance Optimization & Database Objects - CSCI 5603</title>

    <!-- Database Design Presentation Styles with Theme Support -->
    <link rel="stylesheet" href="../../styles/presentation.css">
    <link rel="icon" type="image/x-icon" href="/images/favicon.png">

    <!-- Import Courier Prime for analog feel -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Courier+Prime:wght@400;700&family=IBM+Plex+Mono:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <!-- Lecture-Specific Styles -->
    <style>
        /* Override font for analog feel */
        body, .slide, h1, h2, h3, p, li {
            font-family: 'Courier Prime', 'IBM Plex Mono', 'Courier New', monospace !important;
        }

        /* Database-specific styling */
        .erd-diagram {
            background: var(--bg-accent);
            border: 2px solid var(--border-color);
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            font-family: 'Courier Prime', monospace;
        }

        /* SQL syntax highlighting classes now in presentation.css */

        .table-schema {
            border-collapse: collapse;
            width: 100%;
            margin: 20px 0;
            font-family: 'IBM Plex Mono', monospace;
        }

        .table-schema th {
            background: var(--ocu-true-blue);
            color: white;
            padding: 12px;
            text-align: left;
            font-weight: 600;
        }

        .table-schema td {
            border: 1px solid var(--border-color);
            padding: 10px;
            background: var(--bg-secondary);
        }

        .table-schema tr:nth-child(even) td {
            background: var(--bg-accent);
        }

        /* Bridge to Your Project boxes */
        .bridge-box {
            background-color: #f0f8ff;
            border-left: 4px solid #4a90e2;
            padding: 15px;
            margin: 20px 0;
            font-family: 'Courier Prime', monospace;
        }

        .bridge-box h4 {
            margin-top: 0;
            color: #4a90e2;
        }

        /* Netlify integration callouts */
        .netlify-callout {
            background-color: #e8f5e9;
            border-left: 4px solid #4caf50;
            padding: 15px;
            margin: 20px 0;
        }

        .netlify-callout h4 {
            margin-top: 0;
            color: #2e7d32;
        }

        /* Project example boxes */
        .project-example {
            background-color: #fff3e0;
            border: 1px solid #ff9800;
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
        }

        .project-example strong {
            color: #e65100;
        }

        /* Dark mode overrides for all custom boxes */
        [data-theme='dark'] .bridge-box {
            background-color: #1a2a3a;
            border-left: 4px solid #009edb;
            color: #ffffff;
        }

        [data-theme='dark'] .bridge-box h4 {
            color: #009edb;
        }

        [data-theme='dark'] .netlify-callout {
            background-color: #1a2f1a;
            border-left: 4px solid #70bf54;
            color: #ffffff;
        }

        [data-theme='dark'] .netlify-callout h4 {
            color: #70bf54;
        }

        [data-theme='dark'] .project-example {
            background-color: #2a1f0f;
            border: 1px solid #ff9800;
            color: #ffffff;
        }

        [data-theme='dark'] .project-example strong {
            color: #ffc222;
        }
    </style>
</head>
<body>
    <!-- Theme toggle will be automatically added by JavaScript -->

    <div class="presentation-container">
        <!-- Optional timer display for activities -->
        <div class="timer-display" id="timer-display">
            <span id="timer-text">Advanced SQL: Performance Optimization
                 <button class="home"><a href="../../index.html">Home</a></button>
            </span>
        </div>

        <!-- Slide 1: Title -->
        <div class="slide active">
            <h1>Advanced SQL</h1>
            <h2>Performance Optimization & Database Objects</h2>
            <p style="font-size: 1.5em; margin-top: 40px;">CSCI 5603 - Database Design</p>
            <p style="font-size: 1.3em;">Week 5, Lecture 9</p>
            <p style="margin-top: 60px; font-size: 1.2em;">Instructor: Bobby Reed</p>
            <p style="margin-top: auto; font-style: italic;">Optimize YOUR live Netlify project for peak performance!</p>
        </div>

        <!-- Slide 1a: Transition from Lecture 8 -->
        <div class="slide">
            <h1>From Lecture 8 to Lecture 9</h1>
            <h2>You Built It. Now Make It FAST!</h2>

            <div class="netlify-callout">
                <h4>What You've Built So Far:</h4>
                <ul style="font-size: 1.15em; line-height: 1.8;">
                    <li><strong>Lecture 6:</strong> Live Netlify APIs with database backend</li>
                    <li><strong>Lecture 7:</strong> Filtering, sorting, search, statistics</li>
                    <li><strong>Lecture 8:</strong> JOIN-based endpoints with related data</li>
                </ul>
            </div>

            <div class="demo-box">
                <h3>Today's Mission:</h3>
                <p style="font-size: 1.2em;"><strong>Optimize YOUR project for production-level performance!</strong></p>
                <ul style="font-size: 1.1em; line-height: 1.8;">
                    <li>Measure your actual API response times</li>
                    <li>Identify slow queries with EXPLAIN ANALYZE</li>
                    <li>Add indexes to speed up searches and JOINs</li>
                    <li>Create views to simplify complex queries</li>
                    <li>Deploy optimized version to Netlify</li>
                </ul>
            </div>

            <div class="tip-box">
                <strong>Goal:</strong> 5-10x faster queries = happier users!
            </div>
        </div>

        <!-- Slide 2: Learning Objectives -->
        <div class="slide">
            <h1>Today's Learning Objectives</h1>
            <ul style="font-size: 1.3em; line-height: 2;">
                <li>Optimize YOUR live Netlify API performance</li>
                <li>Create views to simplify YOUR complex queries</li>
                <li>Add indexes to speed up YOUR slow queries</li>
                <li>Measure before/after performance improvements</li>
                <li>Understand and use database triggers</li>
                <li>Design stored procedures for common operations</li>
                <li>Build user-defined functions for custom logic</li>
                <li>Apply performance optimization to YOUR project</li>
            </ul>

            <div class="netlify-callout" style="margin-top: 30px;">
                <h4>Today's Focus</h4>
                <p style="font-size: 1.1em;">You'll learn how to make YOUR live project faster, cleaner, and more maintainable using advanced database features!</p>
            </div>
        </div>

        <!-- Slide 3: Historical Context -->
        <div class="slide">
            <h1>Historical Context</h1>
            <h2>SQL's Continuous Evolution</h2>

            <div class="concept-box">
                <h3>SQL Standard Evolution</h3>
                <p style="font-size: 1.15em; line-height: 1.7;">SQL has evolved through numerous standard revisionsâ€”SQL-92, SQL:1999, SQL:2003, and beyondâ€”each adding powerful new features. SQL-92 established the foundation we use today. SQL:1999 introduced recursive queries and triggers. SQL:2003 added window functions and XML support. These revisions demonstrate SQL's remarkable adaptability: advanced features like window functions, CTEs, and JSON support were added over decades to meet evolving application needs while maintaining backward compatibility.</p>
            </div>

            <div class="tip-box">
                <strong>Key Insight:</strong> SQL's longevity comes from its ability to evolve with technology while preserving its core principles. Modern SQL is far more powerful than its 1970s origins, yet a query from 1987 still runs todayâ€”a testament to careful standards development.
            </div>
        </div>

        <!-- Slide 4: Agenda -->
        <div class="slide">
            <h1>Lecture Roadmap</h1>
            <div class="two-column">
                <div>
                    <h3>Part 1: Performance (45 min)</h3>
                    <ul>
                        <li>Why performance matters</li>
                        <li>Measuring API speed</li>
                        <li>EXPLAIN ANALYZE</li>
                        <li>Creating indexes</li>
                        <li>Using views to simplify</li>
                        <li>Before/after metrics</li>
                    </ul>
                </div>
                <div>
                    <h3>Part 2: Database Objects (45 min)</h3>
                    <ul>
                        <li>Database triggers</li>
                        <li>Stored procedures</li>
                        <li>User-defined functions</li>
                        <li>Query optimization tips</li>
                        <li>Frontend integration</li>
                    </ul>
                </div>
            </div>
            <div class="tip-box">
                <strong>Note:</strong> All examples will use generic schemas or movie_rental_dbâ€”adapt them to YOUR project!
            </div>
        </div>

        <!-- PERFORMANCE OPTIMIZATION SECTION -->

        <!-- Slide 5: Why Performance Matters -->
        <div class="slide">
            <h1>Why Performance Matters for Your Project</h1>
            <h2>Real Impact on User Experience</h2>

            <div class="warning-box">
                <h3>The Reality of Slow Queries:</h3>
                <ul style="font-size: 1.15em; line-height: 1.8;">
                    <li>Users expect pages to load in under 3 seconds</li>
                    <li>53% of mobile users abandon sites that take >3 seconds to load</li>
                    <li>Every 100ms delay = 1% decrease in conversions</li>
                    <li>Slow APIs = frustrated users = abandoned projects</li>
                </ul>
            </div>

            <div class="netlify-callout">
                <h4>Connection to Your Netlify Project</h4>
                <p style="font-size: 1.1em;">Your Netlify frontend depends on fast database queries. A slow query means:</p>
                <ul>
                    <li>Loading spinners that spin forever</li>
                    <li>Frustrated users who close the tab</li>
                    <li>Poor grades on performance metrics</li>
                </ul>
            </div>

            <div class="tip-box">
                <strong>Today's Goal:</strong> Transform your slow queries into lightning-fast responses!
            </div>
        </div>

        <!-- Slide 6: Measuring API Performance -->
        <div class="slide">
            <h1>Measuring YOUR API Speed</h1>
            <h2>Know Your Baseline</h2>

            <div class="netlify-callout">
                <h4>Use Browser DevTools Network Tab</h4>
                <p style="font-size: 1.1em;">This is the easiest way to see how long your API calls take!</p>
            </div>

            <div class="demo-box">
                <h3>How to Measure:</h3>
                <ol style="font-size: 1.15em; line-height: 1.8;">
                    <li>Open your Netlify site in the browser</li>
                    <li>Press <strong>F12</strong> to open DevTools</li>
                    <li>Click the <strong>Network</strong> tab</li>
                    <li>Reload the page (Ctrl+R or Cmd+R)</li>
                    <li>Look for your API calls (e.g., /api/items)</li>
                    <li>Check the <strong>Time</strong> column - this is how long it took!</li>
                </ol>
            </div>

            <div class="concept-box">
                <h3>Performance Goals:</h3>
                <ul style="font-size: 1.15em;">
                    <li><strong>Excellent:</strong> Under 100ms</li>
                    <li><strong>Good:</strong> 100-300ms</li>
                    <li><strong>Acceptable:</strong> 300-500ms</li>
                    <li><strong>Needs Optimization:</strong> Over 500ms</li>
                </ul>
            </div>
        </div>

        <!-- Slide 7: EXPLAIN ANALYZE Introduction -->
        <div class="slide">
            <h1>EXPLAIN ANALYZE: Your Performance Detective</h1>
            <h2>See How PostgreSQL Executes Your Queries</h2>

            <div class="concept-box">
                <h3>What is EXPLAIN?</h3>
                <p style="font-size: 1.15em; line-height: 1.7;">EXPLAIN shows you PostgreSQL's execution planâ€”how it will find the data. EXPLAIN ANALYZE actually runs the query and shows real timing data.</p>
            </div>

            <div class="sql-example">
                <span class="sql-comment">-- Basic EXPLAIN</span><br>
                <span class="sql-keyword">EXPLAIN</span><br>
                <span class="sql-keyword">SELECT</span> * <span class="sql-keyword">FROM</span> items<br>
                <span class="sql-keyword">WHERE</span> category = <span class="sql-string">'Electronics'</span>;<br><br>

                <span class="sql-comment">-- EXPLAIN ANALYZE (runs the query, shows actual timings)</span><br>
                <span class="sql-keyword">EXPLAIN ANALYZE</span><br>
                <span class="sql-keyword">SELECT</span> * <span class="sql-keyword">FROM</span> items<br>
                <span class="sql-keyword">WHERE</span> category = <span class="sql-string">'Electronics'</span>;
            </div>

            <div class="tip-box">
                <strong>Key Terms to Know:</strong>
                <ul>
                    <li><strong>Seq Scan:</strong> Sequential scan - reads every row (SLOW)</li>
                    <li><strong>Index Scan:</strong> Uses an index to jump to rows (FAST)</li>
                    <li><strong>Cost:</strong> Estimated expense (lower is better)</li>
                    <li><strong>Actual time:</strong> Real milliseconds it took</li>
                </ul>
            </div>
        </div>

        <!-- Slide 8: EXPLAIN ANALYZE on YOUR Queries -->
        <div class="slide">
            <h1>Running EXPLAIN ANALYZE on YOUR Queries</h1>

            <div class="sql-example">
                <span class="sql-comment">-- Example with generic schema</span><br>
                <span class="sql-keyword">EXPLAIN ANALYZE</span><br>
                <span class="sql-keyword">SELECT</span> i.*, c.category_name<br>
                <span class="sql-keyword">FROM</span> items i<br>
                <span class="sql-keyword">JOIN</span> categories c <span class="sql-keyword">ON</span> i.category_id = c.category_id<br>
                <span class="sql-keyword">WHERE</span> c.category_name = <span class="sql-string">'Electronics'</span>;
            </div>

            <div class="demo-box">
                <h3>Sample Output (Simplified):</h3>
                <pre style="font-size: 0.9em;">
Nested Loop  (cost=0.00..25.50 rows=10 width=100) (actual time=0.015..0.234 rows=12 loops=1)
  -> Seq Scan on categories c  (cost=0.00..1.50 rows=1 width=32) (actual time=0.008..0.012 rows=1 loops=1)
        Filter: (category_name = 'Electronics')
  -> Seq Scan on items i  (cost=0.00..23.00 rows=10 width=68) (actual time=0.005..0.180 rows=12 loops=1)
        Filter: (category_id = c.category_id)
Planning Time: 0.150 ms
Execution Time: 0.280 ms</pre>
            </div>

            <div class="warning-box">
                <strong>Red Flags:</strong> Look for "Seq Scan" on large tables, high "actual time", or high "cost" values!
            </div>

            <div class="bridge-box">
                <h4>Apply to Your Project</h4>
                <p>Run EXPLAIN ANALYZE on the complex queries from Lectures 7-8. Identify which ones are slow!</p>
            </div>
        </div>

        <!-- Slide 9: What Are Indexes? -->
        <div class="slide">
            <h1>Indexes: The Speed Boost Your DB Needs</h1>
            <h2>Like a Book's Index</h2>

            <div class="concept-box">
                <h3>What Is an Index?</h3>
                <p style="font-size: 1.15em; line-height: 1.7;">An index is a data structure that allows the database to find rows quickly without scanning the entire table. Think of it like an index in a textbookâ€”instead of reading every page to find "PostgreSQL," you look it up in the index and jump directly to page 247.</p>
            </div>

            <div class="comparison-table">
                <div class="comparison-card bad">
                    <h3>Without Index (Seq Scan)</h3>
                    <p>Database reads EVERY row:</p>
                    <ul>
                        <li>Row 1: category='Books'? No</li>
                        <li>Row 2: category='Tools'? No</li>
                        <li>Row 3: category='Electronics'? Yes!</li>
                        <li>...keep checking all 10,000 rows</li>
                    </ul>
                    <p><strong>Time:</strong> O(n) - Linear</p>
                </div>
                <div class="comparison-card good">
                    <h3>With Index (Index Scan)</h3>
                    <p>Database jumps directly:</p>
                    <ul>
                        <li>Look up 'Electronics' in index</li>
                        <li>Index says: rows 234, 567, 891</li>
                        <li>Jump directly to those 3 rows</li>
                        <li>Done!</li>
                    </ul>
                    <p><strong>Time:</strong> O(log n) - Logarithmic</p>
                </div>
            </div>
        </div>

        <!-- Slide 10: Creating Indexes -->
        <div class="slide">
            <h1>Creating Indexes for YOUR Project</h1>

            <div class="sql-example">
                <span class="sql-comment">-- Index on foreign key (very common!)</span><br>
                <span class="sql-keyword">CREATE INDEX</span> idx_items_category<br>
                <span class="sql-keyword">ON</span> items(category_id);<br><br>

                <span class="sql-comment">-- Index on frequently searched column</span><br>
                <span class="sql-keyword">CREATE INDEX</span> idx_items_name<br>
                <span class="sql-keyword">ON</span> items(name);<br><br>

                <span class="sql-comment">-- Composite index (multiple columns)</span><br>
                <span class="sql-keyword">CREATE INDEX</span> idx_items_category_price<br>
                <span class="sql-keyword">ON</span> items(category_id, price);
            </div>

            <div class="tip-box">
                <h3>When to Add Indexes:</h3>
                <ul style="font-size: 1.15em;">
                    <li>Columns used in <strong>WHERE</strong> clauses</li>
                    <li>Columns used in <strong>JOIN</strong> conditions (foreign keys)</li>
                    <li>Columns used in <strong>ORDER BY</strong></li>
                    <li>Columns frequently searched by users</li>
                </ul>
            </div>

            <div class="warning-box">
                <strong>Don't Over-Index!</strong> Indexes speed up reads but slow down writes (INSERT/UPDATE/DELETE). Only index columns you actually query!
            </div>
        </div>

        <!-- Slide 11: Indexes for Different Project Types -->
        <div class="slide">
            <h1>Index Strategy for YOUR Project Type</h1>

            <div class="bridge-box">
                <h4>ðŸŒ‰ Your Classmates' Index Strategies</h4>

                <p><strong>Geethika (Hotel Management):</strong></p>
                <div class="sql-example" style="font-size: 0.9em;">
                    <span class="sql-keyword">CREATE INDEX</span> idx_rooms_availability <span class="sql-keyword">ON</span> rooms(availability_status);<br>
                    <span class="sql-keyword">CREATE INDEX</span> idx_rooms_type_price <span class="sql-keyword">ON</span> rooms(room_type, price_per_night);<br>
                    <span class="sql-keyword">CREATE INDEX</span> idx_bookings_guest <span class="sql-keyword">ON</span> bookings(guest_id);<br>
                    <span class="sql-keyword">CREATE INDEX</span> idx_bookings_dates <span class="sql-keyword">ON</span> bookings(check_in_date, check_out_date);
                </div>

                <p><strong>Suman (Retail Inventory):</strong></p>
                <div class="sql-example" style="font-size: 0.9em;">
                    <span class="sql-keyword">CREATE INDEX</span> idx_products_category <span class="sql-keyword">ON</span> products(category_id);<br>
                    <span class="sql-keyword">CREATE INDEX</span> idx_products_supplier <span class="sql-keyword">ON</span> products(supplier_id);<br>
                    <span class="sql-keyword">CREATE INDEX</span> idx_products_stock <span class="sql-keyword">ON</span> products(quantity_in_stock);<br>
                    <span class="sql-keyword">CREATE INDEX</span> idx_sales_date <span class="sql-keyword">ON</span> sales(sale_date);
                </div>

                <p><strong>Doan (Bakery):</strong></p>
                <div class="sql-example" style="font-size: 0.9em;">
                    <span class="sql-keyword">CREATE INDEX</span> idx_products_category <span class="sql-keyword">ON</span> products(category);<br>
                    <span class="sql-keyword">CREATE INDEX</span> idx_orders_customer <span class="sql-keyword">ON</span> orders(customer_id);<br>
                    <span class="sql-keyword">CREATE INDEX</span> idx_orders_date <span class="sql-keyword">ON</span> orders(order_date);
                </div>

                <p><strong>Hanumantha (Club Membership):</strong></p>
                <div class="sql-example" style="font-size: 0.9em;">
                    <span class="sql-keyword">CREATE INDEX</span> idx_members_status <span class="sql-keyword">ON</span> members(membership_status);<br>
                    <span class="sql-keyword">CREATE INDEX</span> idx_events_date <span class="sql-keyword">ON</span> events(event_date);<br>
                    <span class="sql-keyword">CREATE INDEX</span> idx_registrations_member <span class="sql-keyword">ON</span> event_registrations(member_id);<br>
                    <span class="sql-keyword">CREATE INDEX</span> idx_registrations_event <span class="sql-keyword">ON</span> event_registrations(event_id);
                </div>

                <p><strong>Vineesh (Parking Lot):</strong></p>
                <div class="sql-example" style="font-size: 0.9em;">
                    <span class="sql-keyword">CREATE INDEX</span> idx_availability_status <span class="sql-keyword">ON</span> availability(status);<br>
                    <span class="sql-keyword">CREATE INDEX</span> idx_availability_customer <span class="sql-keyword">ON</span> availability(customer_id);<br>
                    <span class="sql-keyword">CREATE INDEX</span> idx_availability_employee <span class="sql-keyword">ON</span> availability(employee_id);<br>
                    <span class="sql-keyword">CREATE INDEX</span> idx_availability_times <span class="sql-keyword">ON</span> availability(entry_time, exit_time);
                </div>
            </div>
        </div>

        <!-- Slide 12: Database Views -->
        <div class="slide">
            <h1>Database Views</h1>
            <h2>Simplify Complex Queries</h2>

            <div class="concept-box">
                <h3>What Is a View?</h3>
                <p style="font-size: 1.15em; line-height: 1.7;">A view is a virtual table based on a SELECT statement. It doesn't store dataâ€”it's a saved query that you can SELECT from like a table. Perfect for complex JOINs you use repeatedly!</p>
            </div>

            <div class="sql-example">
                <span class="sql-comment">-- Create a view for items with category details</span><br>
                <span class="sql-keyword">CREATE VIEW</span> items_with_details <span class="sql-keyword">AS</span><br>
                <span class="sql-keyword">SELECT</span> i.item_id, i.name, i.price, i.description,<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c.category_name, c.description <span class="sql-keyword">AS</span> category_desc<br>
                <span class="sql-keyword">FROM</span> items i<br>
                <span class="sql-keyword">LEFT JOIN</span> categories c <span class="sql-keyword">ON</span> i.category_id = c.category_id;<br><br>

                <span class="sql-comment">-- Now use it like a table!</span><br>
                <span class="sql-keyword">SELECT</span> * <span class="sql-keyword">FROM</span> items_with_details<br>
                <span class="sql-keyword">WHERE</span> category_name = <span class="sql-string">'Electronics'</span>;
            </div>

            <div class="info-box">
                <h3>View Benefits:</h3>
                <ul>
                    <li>Simplify complex queries</li>
                    <li>Reuse the same JOIN logic everywhere</li>
                    <li>Abstract complexity from API endpoints</li>
                    <li>Security: Hide sensitive columns</li>
                </ul>
            </div>
        </div>

        <!-- Slide 13: Views Simplify Your API Code -->
        <div class="slide">
            <h1>Views Simplify YOUR API Code</h1>

            <div class="comparison-table">
                <div class="comparison-card bad">
                    <h3>Without View (Complex)</h3>
                    <div class="sql-example" style="font-size: 0.75em;">
                        <span class="sql-comment">// In every API endpoint:</span><br>
                        <span class="sql-keyword">const</span> query = <span class="sql-string">`<br>
                        &nbsp;&nbsp;SELECT i.item_id, i.name, i.price,<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c.category_name, s.supplier_name<br>
                        &nbsp;&nbsp;FROM items i<br>
                        &nbsp;&nbsp;LEFT JOIN categories c<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;ON i.category_id = c.category_id<br>
                        &nbsp;&nbsp;LEFT JOIN suppliers s<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;ON i.supplier_id = s.supplier_id<br>
                        &nbsp;&nbsp;WHERE ...<br>
                        `</span>;
                    </div>
                    <p>Repeated complex JOIN in every endpoint!</p>
                </div>
                <div class="comparison-card good">
                    <h3>With View (Simple)</h3>
                    <div class="sql-example" style="font-size: 0.75em;">
                        <span class="sql-comment">// Create view once in DB:</span><br>
                        <span class="sql-keyword">CREATE VIEW</span> items_full <span class="sql-keyword">AS</span><br>
                        <span class="sql-keyword">SELECT</span> i.*, c.category_name,<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s.supplier_name<br>
                        <span class="sql-keyword">FROM</span> items i<br>
                        <span class="sql-keyword">LEFT JOIN</span> categories c ...<br>
                        <span class="sql-keyword">LEFT JOIN</span> suppliers s ...;<br><br>

                        <span class="sql-comment">// In API endpoints:</span><br>
                        <span class="sql-keyword">const</span> query = <span class="sql-string">`SELECT * FROM items_full WHERE ...`</span>;
                    </div>
                    <p>Simple query, all the power!</p>
                </div>
            </div>
        </div>

        <!-- Slide 14: Creating Views for Your Project -->
        <div class="slide">
            <h1>Creating Views for YOUR Project</h1>

            <div class="bridge-box">
                <h4>ðŸŒ‰ Your Classmates' View Examples</h4>

                <p><strong>Geethika (Hotel Management):</strong></p>
                <div class="sql-example" style="font-size: 0.85em;">
                    <span class="sql-keyword">CREATE VIEW</span> bookings_summary <span class="sql-keyword">AS</span><br>
                    <span class="sql-keyword">SELECT</span> b.booking_id, g.name <span class="sql-keyword">AS</span> guest_name, r.room_type,<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b.check_in_date, b.check_out_date, b.total_cost<br>
                    <span class="sql-keyword">FROM</span> bookings b<br>
                    <span class="sql-keyword">JOIN</span> guests g <span class="sql-keyword">ON</span> b.guest_id = g.guest_id<br>
                    <span class="sql-keyword">JOIN</span> rooms r <span class="sql-keyword">ON</span> b.room_id = r.room_id;
                </div>

                <p><strong>Suman (Retail Inventory):</strong></p>
                <div class="sql-example" style="font-size: 0.85em;">
                    <span class="sql-keyword">CREATE VIEW</span> inventory_status <span class="sql-keyword">AS</span><br>
                    <span class="sql-keyword">SELECT</span> p.product_name, c.category_name, s.supplier_name,<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p.quantity_in_stock, p.reorder_level,<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql-keyword">CASE WHEN</span> p.quantity_in_stock < p.reorder_level <span class="sql-keyword">THEN</span> <span class="sql-string">'Low Stock'</span> <span class="sql-keyword">ELSE</span> <span class="sql-string">'OK'</span> <span class="sql-keyword">END</span> <span class="sql-keyword">AS</span> stock_status<br>
                    <span class="sql-keyword">FROM</span> products p<br>
                    <span class="sql-keyword">JOIN</span> categories c <span class="sql-keyword">ON</span> p.category_id = c.category_id<br>
                    <span class="sql-keyword">JOIN</span> suppliers s <span class="sql-keyword">ON</span> p.supplier_id = s.supplier_id;
                </div>

                <p><strong>Doan (Bakery):</strong></p>
                <div class="sql-example" style="font-size: 0.85em;">
                    <span class="sql-keyword">CREATE VIEW</span> order_details <span class="sql-keyword">AS</span><br>
                    <span class="sql-keyword">SELECT</span> o.order_id, c.name <span class="sql-keyword">AS</span> customer_name, p.product_name,<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;o.quantity, o.total_price, o.order_date<br>
                    <span class="sql-keyword">FROM</span> orders o<br>
                    <span class="sql-keyword">JOIN</span> customers c <span class="sql-keyword">ON</span> o.customer_id = c.customer_id<br>
                    <span class="sql-keyword">JOIN</span> products p <span class="sql-keyword">ON</span> o.product_id = p.product_id;
                </div>

                <p><strong>Hanumantha (Club Membership):</strong></p>
                <div class="sql-example" style="font-size: 0.85em;">
                    <span class="sql-keyword">CREATE VIEW</span> event_attendance <span class="sql-keyword">AS</span><br>
                    <span class="sql-keyword">SELECT</span> e.event_name, e.event_date, e.location,<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m.name <span class="sql-keyword">AS</span> member_name, er.registration_date<br>
                    <span class="sql-keyword">FROM</span> event_registrations er<br>
                    <span class="sql-keyword">JOIN</span> members m <span class="sql-keyword">ON</span> er.member_id = m.member_id<br>
                    <span class="sql-keyword">JOIN</span> events e <span class="sql-keyword">ON</span> er.event_id = e.event_id;
                </div>

                <p><strong>Vineesh (Parking Lot):</strong></p>
                <div class="sql-example" style="font-size: 0.85em;">
                    <span class="sql-keyword">CREATE VIEW</span> parking_details <span class="sql-keyword">AS</span><br>
                    <span class="sql-keyword">SELECT</span> a.slot_id, c.customer_name, c.vehicle_number,<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e.full_name <span class="sql-keyword">AS</span> employee_name, a.entry_time, a.exit_time,<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql-function">EXTRACT</span>(<span class="sql-keyword">EPOCH FROM</span> (a.exit_time - a.entry_time))/3600 <span class="sql-keyword">AS</span> hours_parked<br>
                    <span class="sql-keyword">FROM</span> availability a<br>
                    <span class="sql-keyword">LEFT JOIN</span> customers c <span class="sql-keyword">ON</span> a.customer_id = c.customer_id<br>
                    <span class="sql-keyword">LEFT JOIN</span> employees e <span class="sql-keyword">ON</span> a.employee_id = e.employee_id;
                </div>
            </div>
        </div>

        <!-- Slide 15: Before/After Performance Metrics -->
        <div class="slide">
            <h1>Before/After Performance</h1>
            <h2>Measuring the Impact</h2>

            <div class="demo-box">
                <h3>Example Improvements:</h3>
                <table class="table-schema">
                    <tr>
                        <th>Query Type</th>
                        <th>Before (no index)</th>
                        <th>After (with index)</th>
                        <th>Improvement</th>
                    </tr>
                    <tr>
                        <td>Simple WHERE</td>
                        <td>450ms</td>
                        <td>45ms</td>
                        <td>10x faster!</td>
                    </tr>
                    <tr>
                        <td>JOIN query</td>
                        <td>680ms</td>
                        <td>120ms</td>
                        <td>5.7x faster!</td>
                    </tr>
                    <tr>
                        <td>Complex aggregation</td>
                        <td>1200ms</td>
                        <td>280ms</td>
                        <td>4.3x faster!</td>
                    </tr>
                </table>
            </div>

            <div class="netlify-callout">
                <h4>Frontend Load Time Impact:</h4>
                <ul style="font-size: 1.15em;">
                    <li><strong>Before optimization:</strong> Page loads in 2.5 seconds</li>
                    <li><strong>After optimization:</strong> Page loads in 0.4 seconds</li>
                    <li><strong>User experience:</strong> Instant, delightful, professional!</li>
                </ul>
            </div>
        </div>

        <!-- Slide 16: Frontend Performance Integration -->
        <div class="slide">
            <h1>Show Performance in Browser</h1>
            <h2>Measuring Frontend Impact</h2>

            <div class="demo-box">
                <h3>Steps to Measure:</h3>
                <ol style="font-size: 1.15em; line-height: 1.8;">
                    <li>Open DevTools (F12)</li>
                    <li>Go to Network tab</li>
                    <li>Clear network log (trash icon)</li>
                    <li>Reload your Netlify site</li>
                    <li>Look for API call duration</li>
                    <li>After optimization: reload and compare!</li>
                </ol>
            </div>

            <div class="tip-box">
                <h3>What to Look For:</h3>
                <ul style="font-size: 1.1em;">
                    <li><strong>Waiting (TTFB):</strong> Time to First Byte - how long server took</li>
                    <li><strong>Content Download:</strong> Time to download response</li>
                    <li><strong>Total Time:</strong> Waiting + Content Download</li>
                </ul>
            </div>

            <div class="bridge-box">
                <h4>Document Your Improvements</h4>
                <p>Take screenshots before and after optimizationâ€”this is impressive evidence for your homework!</p>
            </div>
        </div>

        <!-- Slide 17: Loading States for Slow Queries -->
        <div class="slide">
            <h1>Loading States for Slow Queries</h1>
            <h2>Better UX While Data Fetches</h2>

            <div class="sql-example">
                <span class="sql-comment">// JavaScript: Add loading spinner while data fetches</span><br>
                <span class="sql-keyword">async function</span> loadData() {<br>
                &nbsp;&nbsp;showSpinner();<br>
                &nbsp;&nbsp;<span class="sql-keyword">try</span> {<br>
                &nbsp;&nbsp;&nbsp;&nbsp;<span class="sql-keyword">const</span> response = <span class="sql-keyword">await</span> fetch(<span class="sql-string">'/api/complex-query'</span>);<br>
                &nbsp;&nbsp;&nbsp;&nbsp;<span class="sql-keyword">const</span> data = <span class="sql-keyword">await</span> response.json();<br>
                &nbsp;&nbsp;&nbsp;&nbsp;displayData(data);<br>
                &nbsp;&nbsp;} <span class="sql-keyword">catch</span> (error) {<br>
                &nbsp;&nbsp;&nbsp;&nbsp;console.error(error);<br>
                &nbsp;&nbsp;} <span class="sql-keyword">finally</span> {<br>
                &nbsp;&nbsp;&nbsp;&nbsp;hideSpinner();<br>
                &nbsp;&nbsp;}<br>
                }<br><br>

                <span class="sql-keyword">function</span> showSpinner() {<br>
                &nbsp;&nbsp;document.getElementById(<span class="sql-string">'spinner'</span>).style.display = <span class="sql-string">'block'</span>;<br>
                }<br><br>

                <span class="sql-keyword">function</span> hideSpinner() {<br>
                &nbsp;&nbsp;document.getElementById(<span class="sql-string">'spinner'</span>).style.display = <span class="sql-string">'none'</span>;<br>
                }
            </div>
        </div>

        <!-- Slide 18: CSS for Loading Spinner -->
        <div class="slide">
            <h1>CSS for Loading States</h1>

            <div class="sql-example">
                <span class="sql-comment">/* CSS for animated loading spinner */</span><br>
                .loading-spinner {<br>
                &nbsp;&nbsp;border: 4px solid #f3f3f3;<br>
                &nbsp;&nbsp;border-top: 4px solid #667eea;<br>
                &nbsp;&nbsp;border-radius: 50%;<br>
                &nbsp;&nbsp;width: 40px;<br>
                &nbsp;&nbsp;height: 40px;<br>
                &nbsp;&nbsp;animation: spin 1s linear infinite;<br>
                &nbsp;&nbsp;margin: 20px auto;<br>
                }<br><br>

                @keyframes spin {<br>
                &nbsp;&nbsp;0% { transform: rotate(0deg); }<br>
                &nbsp;&nbsp;100% { transform: rotate(360deg); }<br>
                }<br><br>

                .loading-text {<br>
                &nbsp;&nbsp;text-align: center;<br>
                &nbsp;&nbsp;color: #667eea;<br>
                &nbsp;&nbsp;font-size: 1.1em;<br>
                &nbsp;&nbsp;margin-top: 10px;<br>
                }
            </div>

            <div class="demo-box">
                <h3>HTML Structure:</h3>
                <pre style="font-size: 0.9em;">
&lt;div id="spinner" class="loading-spinner" style="display: none;"&gt;&lt;/div&gt;
&lt;p class="loading-text" id="loading-text" style="display: none;"&gt;Loading data...&lt;/p&gt;</pre>
            </div>
        </div>

        <!-- DATABASE OBJECTS SECTION -->

        <!-- Slide 19: Introduction to Triggers -->
        <div class="slide">
            <h1>Database Triggers</h1>
            <p>Automated actions that respond to database events:</p>

            <div class="info-box">
                <h3>Trigger Components:</h3>
                <ul>
                    <li><strong>Event:</strong> INSERT, UPDATE, or DELETE</li>
                    <li><strong>Timing:</strong> BEFORE, AFTER, or INSTEAD OF</li>
                    <li><strong>Level:</strong> Row-level or Statement-level</li>
                    <li><strong>Action:</strong> SQL statements to execute</li>
                </ul>
            </div>

            <div class="sql-example">
                <span class="sql-comment">-- Example: Auto-update timestamp trigger</span><br>
                <span class="sql-keyword">CREATE TRIGGER</span> update_modified_timestamp<br>
                <span class="sql-keyword">BEFORE UPDATE ON</span> items<br>
                <span class="sql-keyword">FOR EACH ROW</span><br>
                <span class="sql-keyword">EXECUTE FUNCTION</span> update_timestamp();<br><br>

                <span class="sql-comment">-- The function that the trigger calls</span><br>
                <span class="sql-keyword">CREATE FUNCTION</span> update_timestamp()<br>
                <span class="sql-keyword">RETURNS TRIGGER AS</span> $$<br>
                <span class="sql-keyword">BEGIN</span><br>
                &nbsp;&nbsp;NEW.updated_at = NOW();<br>
                &nbsp;&nbsp;<span class="sql-keyword">RETURN</span> NEW;<br>
                <span class="sql-keyword">END</span>;<br>
                $$ <span class="sql-keyword">LANGUAGE</span> plpgsql;
            </div>
        </div>

        <!-- Slide 20: Triggers for Your Project -->
        <div class="slide">
            <h1>Trigger Use Cases for YOUR Project</h1>

            <div class="bridge-box">
                <h4>Auto-Update Timestamps</h4>
                <p>Automatically set updated_at whenever a row is modified</p>
                <div class="project-example">
                    <strong>Any project:</strong> Track when records were last modified without manual code
                </div>
            </div>

            <div class="bridge-box">
                <h4>Audit Logging</h4>
                <p>Record who changed what and when</p>
                <div class="project-example">
                    <strong>Inventory:</strong> Log all price changes to audit_log table<br>
                    <strong>Recipe DB:</strong> Track when recipes are modified<br>
                    <strong>Movie rental:</strong> Log all rental transactions
                </div>
            </div>

            <div class="bridge-box">
                <h4>Inventory Management</h4>
                <p>Auto-update stock levels</p>
                <div class="project-example">
                    <strong>E-commerce:</strong> When order is placed, decrease product quantity<br>
                    <strong>Library:</strong> Update available_copies when book is checked out
                </div>
            </div>
        </div>

        <!-- Slide 21: Trigger Advantages and Disadvantages -->
        <div class="slide">
            <h1>Triggers: Pros and Cons</h1>

            <div class="comparison-table">
                <div class="comparison-card good">
                    <h3>Advantages</h3>
                    <ul>
                        <li>Elimination of redundant code</li>
                        <li>Simplifying modifications</li>
                        <li>Increased security</li>
                        <li>Improved data integrity</li>
                        <li>Enhanced processing power</li>
                        <li>Good fit with client-server architecture</li>
                    </ul>
                </div>
                <div class="comparison-card bad">
                    <h3>Disadvantages</h3>
                    <ul>
                        <li>Performance overhead</li>
                        <li>Cascading effects (trigger chains)</li>
                        <li>Cannot be scheduled</li>
                        <li>Less portable across databases</li>
                        <li>Hidden business logic</li>
                        <li>Debugging complexity</li>
                    </ul>
                </div>
            </div>

            <div class="tip-box">
                <strong>Best Practice:</strong> Use triggers sparingly for critical integrity constraints and audit trails.
            </div>
        </div>

        <!-- Slide 22: Stored Procedures -->
        <div class="slide">
            <h1>Stored Procedures</h1>
            <p>Precompiled SQL code stored in the database for reuse:</p>

            <div class="sql-example">
                <span class="sql-comment">-- Example: Procedure to update inventory</span><br>
                <span class="sql-keyword">CREATE OR REPLACE PROCEDURE</span> update_inventory(<br>
                &nbsp;&nbsp;p_item_id <span class="sql-keyword">INT</span>,<br>
                &nbsp;&nbsp;p_quantity_change <span class="sql-keyword">INT</span><br>
                )<br>
                <span class="sql-keyword">LANGUAGE</span> plpgsql<br>
                <span class="sql-keyword">AS</span> $$<br>
                <span class="sql-keyword">BEGIN</span><br>
                &nbsp;&nbsp;<span class="sql-keyword">UPDATE</span> items<br>
                &nbsp;&nbsp;<span class="sql-keyword">SET</span> quantity_in_stock = quantity_in_stock + p_quantity_change,<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;updated_at = NOW()<br>
                &nbsp;&nbsp;<span class="sql-keyword">WHERE</span> item_id = p_item_id;<br><br>

                &nbsp;&nbsp;<span class="sql-keyword">IF NOT FOUND THEN</span><br>
                &nbsp;&nbsp;&nbsp;&nbsp;<span class="sql-keyword">RAISE EXCEPTION</span> <span class="sql-string">'Item % not found'</span>, p_item_id;<br>
                &nbsp;&nbsp;<span class="sql-keyword">END IF</span>;<br>
                <span class="sql-keyword">END</span>;<br>
                $$;<br><br>

                <span class="sql-comment">-- Execute the procedure</span><br>
                <span class="sql-keyword">CALL</span> update_inventory(101, -5);
            </div>

            <p>Benefits: Performance, security, code reuse, reduced network traffic</p>
        </div>

        <!-- Slide 23: Stored Procedures for Your Project -->
        <div class="slide">
            <h1>Stored Procedure Examples</h1>

            <div class="bridge-box">
                <h4>Recipe Database:</h4>
                <div class="sql-example" style="font-size: 0.85em;">
                    <span class="sql-keyword">CREATE PROCEDURE</span> add_recipe_rating(<br>
                    &nbsp;&nbsp;p_recipe_id <span class="sql-keyword">INT</span>,<br>
                    &nbsp;&nbsp;p_user_id <span class="sql-keyword">INT</span>,<br>
                    &nbsp;&nbsp;p_rating <span class="sql-keyword">INT</span><br>
                    ) ...
                </div>
                <p>Insert rating and update recipe's average rating</p>
            </div>

            <div class="bridge-box">
                <h4>Movie Rental Database:</h4>
                <div class="sql-example" style="font-size: 0.85em;">
                    <span class="sql-keyword">CREATE PROCEDURE</span> process_rental(<br>
                    &nbsp;&nbsp;p_member_id <span class="sql-keyword">INT</span>,<br>
                    &nbsp;&nbsp;p_movie_id <span class="sql-keyword">INT</span><br>
                    ) ...
                </div>
                <p>Create rental record, check availability, update status</p>
            </div>

            <div class="bridge-box">
                <h4>E-commerce/Inventory:</h4>
                <div class="sql-example" style="font-size: 0.85em;">
                    <span class="sql-keyword">CREATE PROCEDURE</span> process_order(<br>
                    &nbsp;&nbsp;p_customer_id <span class="sql-keyword">INT</span>,<br>
                    &nbsp;&nbsp;p_product_id <span class="sql-keyword">INT</span>,<br>
                    &nbsp;&nbsp;p_quantity <span class="sql-keyword">INT</span><br>
                    ) ...
                </div>
                <p>Create order, decrease stock, calculate total</p>
            </div>
        </div>

        <!-- Slide 24: User-Defined Functions -->
        <div class="slide">
            <h1>User-Defined Functions (UDFs)</h1>
            <p>Custom functions that return values for use in queries:</p>

            <div class="comparison-table">
                <div class="comparison-card">
                    <h3>Scalar Functions</h3>
                    <p>Return a single value</p>
                    <div class="sql-example" style="margin-top: 10px; font-size: 0.85em;">
                        <span class="sql-keyword">CREATE FUNCTION</span> calculate_discount(<br>
                        &nbsp;&nbsp;price <span class="sql-keyword">DECIMAL</span>,<br>
                        &nbsp;&nbsp;discount_pct <span class="sql-keyword">INT</span><br>
                        )<br>
                        <span class="sql-keyword">RETURNS DECIMAL AS</span> $$<br>
                        <span class="sql-keyword">BEGIN</span><br>
                        &nbsp;&nbsp;<span class="sql-keyword">RETURN</span> price * (1 - discount_pct/100.0);<br>
                        <span class="sql-keyword">END</span>;<br>
                        $$ <span class="sql-keyword">LANGUAGE</span> plpgsql;
                    </div>
                </div>
                <div class="comparison-card">
                    <h3>Table-Valued Functions</h3>
                    <p>Return a table result set</p>
                    <div class="sql-example" style="margin-top: 10px; font-size: 0.85em;">
                        <span class="sql-keyword">CREATE FUNCTION</span> get_items_by_category(<br>
                        &nbsp;&nbsp;p_category <span class="sql-keyword">VARCHAR</span><br>
                        )<br>
                        <span class="sql-keyword">RETURNS TABLE</span> (<br>
                        &nbsp;&nbsp;item_id <span class="sql-keyword">INT</span>,<br>
                        &nbsp;&nbsp;name <span class="sql-keyword">VARCHAR</span>,<br>
                        &nbsp;&nbsp;price <span class="sql-keyword">DECIMAL</span><br>
                        ) <span class="sql-keyword">AS</span> $$<br>
                        <span class="sql-keyword">BEGIN</span><br>
                        &nbsp;&nbsp;<span class="sql-keyword">RETURN QUERY</span><br>
                        &nbsp;&nbsp;<span class="sql-keyword">SELECT</span> i.item_id, i.name, i.price<br>
                        &nbsp;&nbsp;<span class="sql-keyword">FROM</span> items i<br>
                        &nbsp;&nbsp;<span class="sql-keyword">WHERE</span> i.category = p_category;<br>
                        <span class="sql-keyword">END</span>;<br>
                        $$ <span class="sql-keyword">LANGUAGE</span> plpgsql;
                    </div>
                </div>
            </div>
        </div>

        <!-- Slide 25: View Restrictions -->
        <div class="slide">
            <h1>View Limitations</h1>

            <div class="warning-box">
                <h3>Update Restrictions:</h3>
                <ul>
                    <li>Cannot update views with GROUP BY or aggregate functions</li>
                    <li>Cannot update views with DISTINCT</li>
                    <li>Cannot update computed columns</li>
                    <li>Cannot update views joining multiple tables (usually)</li>
                </ul>
            </div>

            <div class="info-box">
                <h3>Other Limitations:</h3>
                <ul>
                    <li><strong>Structure Restriction:</strong> View structure fixed at creation</li>
                    <li><strong>Performance:</strong> Complex views may impact query performance</li>
                    <li><strong>Dependency:</strong> Changes to base tables can break views</li>
                </ul>
            </div>

            <div class="tip-box">
                <strong>Best Practice:</strong> Use views for read-heavy operations. For updates, work with base tables directly.
            </div>
        </div>

        <!-- Slide 26: Performance Best Practices -->
        <div class="slide">
            <h1>Query Optimization Best Practices</h1>

            <div class="comparison-table">
                <div class="comparison-card good">
                    <h3>DO</h3>
                    <ul>
                        <li>Use appropriate indexes</li>
                        <li>Specify exact columns, avoid SELECT *</li>
                        <li>Filter early with WHERE</li>
                        <li>Use EXISTS over IN for large datasets</li>
                        <li>Analyze query plans with EXPLAIN</li>
                        <li>Create views for complex repeated JOINs</li>
                    </ul>
                </div>
                <div class="comparison-card bad">
                    <h3>AVOID</h3>
                    <ul>
                        <li>SELECT * in production</li>
                        <li>Unnecessary nested subqueries</li>
                        <li>Over-indexing (slows writes)</li>
                        <li>DISTINCT when not needed</li>
                        <li>Functions in WHERE clauses</li>
                        <li>Missing indexes on foreign keys</li>
                    </ul>
                </div>
            </div>

            <div class="tip-box">
                <strong>Golden Rule:</strong> Measure first, optimize second! Always use EXPLAIN ANALYZE before and after.
            </div>
        </div>

        <!-- Slide 27: Common Pitfalls -->
        <div class="slide">
            <h1>Common Mistakes to Avoid</h1>

            <div class="warning-box">
                <h3>Don't Do This:</h3>
                <ul>
                    <li>Creating triggers that call other triggers (cascading)</li>
                    <li>Using cursors when set-based operations work</li>
                    <li>Forgetting to handle NULL values in functions</li>
                    <li>Creating views with SELECT * from base tables</li>
                    <li>Ignoring transaction boundaries in procedures</li>
                    <li>Adding indexes to every column (over-indexing)</li>
                </ul>
            </div>

            <div class="success-box">
                <h3>Do This Instead:</h3>
                <ul>
                    <li>Keep triggers simple and focused</li>
                    <li>Use set-based operations whenever possible</li>
                    <li>Always handle NULLs explicitly</li>
                    <li>Specify exact columns in views</li>
                    <li>Use proper transaction management</li>
                    <li>Index only frequently queried columns</li>
                </ul>
            </div>
        </div>

        <!-- IN-CLASS EXERCISES -->

        <!-- Slide 28: Exercise 1 - Optimize YOUR Query -->
        <div class="slide">
            <h1>Exercise 1: Optimize YOUR Query</h1>
            <h2>20-Minute Challenge</h2>

            <div class="activity-box">
                <h3>Your Task:</h3>
                <p style="font-size: 1.15em;">Take one of YOUR complex queries from Lectures 7-8, analyze it, and optimize it!</p>
            </div>

            <div class="demo-box">
                <h3>Steps:</h3>
                <ol style="font-size: 1.1em; line-height: 1.8;">
                    <li><strong>Choose a query:</strong> Pick a JOIN or aggregate query from your project</li>
                    <li><strong>Run EXPLAIN ANALYZE:</strong> Get baseline performance</li>
                    <li><strong>Identify bottleneck:</strong> Look for Seq Scan, high cost, slow time</li>
                    <li><strong>Add an index:</strong> Create index on the bottleneck column(s)</li>
                    <li><strong>Re-run EXPLAIN ANALYZE:</strong> Compare before/after</li>
                    <li><strong>Document results:</strong> Note the improvement!</li>
                </ol>
            </div>

            <div class="tip-box">
                <strong>Hint:</strong> Focus on columns used in WHERE, JOIN ON, or ORDER BY clauses!
            </div>

            <button data-timer="1200">Start 20-Minute Timer</button>
        </div>

        <!-- Slide 29: Exercise 2 - Create a View -->
        <div class="slide">
            <h1>Exercise 2: Create a View for YOUR Project</h1>
            <h2>15-Minute Challenge</h2>

            <div class="activity-box">
                <h3>Your Task:</h3>
                <p style="font-size: 1.15em;">Create a view that simplifies one of YOUR complex queries!</p>
            </div>

            <div class="demo-box">
                <h3>Requirements:</h3>
                <ul style="font-size: 1.1em; line-height: 1.8;">
                    <li>Choose a query you use in multiple API endpoints (or could use)</li>
                    <li>Create a view with a descriptive name (e.g., items_with_details)</li>
                    <li>Include at least one JOIN</li>
                    <li>Test the view: SELECT * FROM your_view;</li>
                    <li>Update one API endpoint to use the view</li>
                </ul>
            </div>

            <div class="bridge-box">
                <h4>Example View Names:</h4>
                <ul>
                    <li><strong>Recipe DB:</strong> recipes_with_ingredients, recipes_full_details</li>
                    <li><strong>Movie rental:</strong> movies_with_studios_and_ratings</li>
                    <li><strong>Inventory:</strong> products_with_supplier_and_stock</li>
                    <li><strong>Events:</strong> events_with_venue_details</li>
                </ul>
            </div>

            <button data-timer="900">Start 15-Minute Timer</button>
        </div>

        <!-- HOMEWORK SECTION -->

        <!-- Slide 30: Homework Overview -->
        <div class="slide">
            <h1>HOMEWORK ASSIGNMENT</h1>
            <h2>Performance Optimization for YOUR Project</h2>

            <div class="demo-box">
                <h3>Assignment Overview (100 points):</h3>
                <p style="font-size: 1.15em;">Optimize YOUR live Netlify project with indexes, views, and performance measurements. This is hands-on work on YOUR actual database!</p>
            </div>

            <div class="activity-box">
                <h3>Three Parts:</h3>
                <ol style="font-size: 1.15em; line-height: 1.8;">
                    <li><strong>Part 1:</strong> EXPLAIN Analysis (30 points)</li>
                    <li><strong>Part 2:</strong> Optimization Implementation (40 points)</li>
                    <li><strong>Part 3:</strong> Performance Measurement (30 points)</li>
                    <li><strong>Bonus:</strong> Advanced Optimization (+10 points)</li>
                </ol>
            </div>

            <div class="tip-box">
                <h3>Due Date: <strong>Before Next Class</strong></h3>
                <p>Submit commit URL to D2L</p>
            </div>
        </div>

        <!-- Slide 31: Part 1 - EXPLAIN Analysis -->
        <div class="slide">
            <h1>Part 1: EXPLAIN Analysis</h1>
            <h2>30 Points</h2>

            <div class="activity-box">
                <h3>Your Task:</h3>
                <p style="font-size: 1.15em;">Run EXPLAIN ANALYZE on <strong>3 of YOUR queries</strong> from Lectures 7-8 and analyze the results.</p>
            </div>

            <div class="demo-box">
                <h3>Requirements:</h3>
                <ul style="font-size: 1.1em; line-height: 1.8;">
                    <li>Choose 3 different queries (at least one JOIN, one with WHERE)</li>
                    <li>Run EXPLAIN ANALYZE on each query</li>
                    <li>Take screenshots of the EXPLAIN output</li>
                    <li>Identify bottlenecks: Seq Scan, high cost, slow actual time</li>
                    <li>Write analysis (150-200 words per query) explaining:
                        <ul style="margin-top: 10px;">
                            <li>What the query does</li>
                            <li>What EXPLAIN shows (scan types, costs, timings)</li>
                            <li>Where the bottleneck is</li>
                            <li>What optimization you'll apply</li>
                        </ul>
                    </li>
                </ul>
            </div>

            <div class="tip-box">
                <strong>Include in Markdown:</strong> Screenshots + written analysis for all 3 queries
            </div>
        </div>

        <!-- Slide 32: Part 2 - Optimization Implementation -->
        <div class="slide">
            <h1>Part 2: Optimization Implementation</h1>
            <h2>40 Points</h2>

            <div class="activity-box">
                <h3>Your Task:</h3>
                <p style="font-size: 1.15em;">Apply optimizations to YOUR database: create views and add indexes!</p>
            </div>

            <div class="demo-box">
                <h3>Requirements:</h3>
                <ol style="font-size: 1.1em; line-height: 1.8;">
                    <li><strong>Create 2 views</strong> for complex queries you use in multiple API endpoints
                        <ul style="margin-top: 8px;">
                            <li>Each view must include at least one JOIN</li>
                            <li>Give views descriptive names</li>
                            <li>Update at least one API endpoint to use each view</li>
                        </ul>
                    </li>
                    <li><strong>Add 3 indexes</strong> based on your EXPLAIN analysis
                        <ul style="margin-top: 8px;">
                            <li>Index columns used in WHERE clauses</li>
                            <li>Index foreign key columns used in JOINs</li>
                            <li>Index columns used in ORDER BY</li>
                        </ul>
                    </li>
                    <li><strong>Re-run EXPLAIN ANALYZE</strong> on the same 3 queries
                        <ul style="margin-top: 8px;">
                            <li>Compare before/after scan types (Seq Scan â†’ Index Scan)</li>
                            <li>Compare before/after execution times</li>
                            <li>Document improvements</li>
                        </ul>
                    </li>
                </ol>
            </div>
        </div>

        <!-- Slide 33: Part 3 - Performance Measurement -->
        <div class="slide">
            <h1>Part 3: Performance Measurement</h1>
            <h2>30 Points</h2>

            <div class="activity-box">
                <h3>Your Task:</h3>
                <p style="font-size: 1.15em;">Measure the frontend performance impact of your optimizations!</p>
            </div>

            <div class="demo-box">
                <h3>Requirements:</h3>
                <ol style="font-size: 1.1em; line-height: 1.8;">
                    <li><strong>Before Optimization:</strong>
                        <ul style="margin-top: 8px;">
                            <li>Open your Netlify site</li>
                            <li>Open DevTools Network tab</li>
                            <li>Record API response times for 3 endpoints</li>
                            <li>Take screenshots showing timings</li>
                        </ul>
                    </li>
                    <li><strong>After Optimization:</strong>
                        <ul style="margin-top: 8px;">
                            <li>Deploy optimized database (with indexes/views)</li>
                            <li>Reload Netlify site</li>
                            <li>Record new API response times</li>
                            <li>Take screenshots showing improvements</li>
                        </ul>
                    </li>
                    <li><strong>Create comparison table/chart:</strong>
                        <ul style="margin-top: 8px;">
                            <li>Show before/after times for each endpoint</li>
                            <li>Calculate % improvement</li>
                            <li>Include total page load time</li>
                        </ul>
                    </li>
                    <li><strong>Deploy optimized version</strong> to Netlify</li>
                </ol>
            </div>
        </div>

        <!-- Slide 34: Bonus - Advanced Optimization -->
        <div class="slide">
            <h1>BONUS: Advanced Optimization</h1>
            <h2>+10 Points</h2>

            <div class="activity-box">
                <h3>Optional Enhancement:</h3>
                <p style="font-size: 1.15em;">Implement a trigger or stored procedure for YOUR project!</p>
            </div>

            <div class="demo-box">
                <h3>Options (choose one):</h3>
                <ul style="font-size: 1.1em; line-height: 1.8;">
                    <li><strong>Trigger:</strong> Auto-update timestamp (updated_at column)
                        <ul style="margin-top: 8px;">
                            <li>Create trigger on one of your tables</li>
                            <li>Test by updating a row, verify timestamp changes</li>
                        </ul>
                    </li>
                    <li><strong>Trigger:</strong> Audit logging
                        <ul style="margin-top: 8px;">
                            <li>Create audit_log table</li>
                            <li>Log all updates to important table</li>
                        </ul>
                    </li>
                    <li><strong>Stored Procedure:</strong> Common operation
                        <ul style="margin-top: 8px;">
                            <li>Create procedure for complex operation (update inventory, process order, etc.)</li>
                            <li>Call it from an API endpoint</li>
                        </ul>
                    </li>
                </ul>
            </div>

            <div class="tip-box">
                <strong>Document:</strong> Explain the use case, show the code, prove it works!
            </div>
        </div>

        <!-- Slide 35: Submission Requirements -->
        <div class="slide">
            <h1>Submission Requirements</h1>

            <div class="demo-box">
                <h3>What to Submit:</h3>
                <ol style="font-size: 1.15em; line-height: 1.8;">
                    <li><strong>Markdown File (.md)</strong> in your GitHub homework repository:
                        <ul style="margin-top: 10px;">
                            <li>File naming: LastName_FirstName_Week9_Homework.md</li>
                            <li>Include all 3 parts with clear headings</li>
                        </ul>
                    </li>
                    <li><strong>Screenshots:</strong>
                        <ul style="margin-top: 10px;">
                            <li>EXPLAIN ANALYZE output (before/after for all 3 queries)</li>
                            <li>DevTools Network tab (before/after timings)</li>
                            <li>Comparison table or chart</li>
                        </ul>
                    </li>
                    <li><strong>SQL Code:</strong>
                        <ul style="margin-top: 10px;">
                            <li>All CREATE VIEW statements</li>
                            <li>All CREATE INDEX statements</li>
                            <li>Trigger/procedure code (if doing bonus)</li>
                        </ul>
                    </li>
                    <li><strong>Analysis:</strong>
                        <ul style="margin-top: 10px;">
                            <li>Written explanations for Part 1 (150-200 words each)</li>
                            <li>Performance improvement summary</li>
                        </ul>
                    </li>
                </ol>
            </div>

            <div class="warning-box">
                <h3>Submission:</h3>
                <p><strong>Submit commit URL to D2L</strong> (not the file itself - the GitHub commit URL)</p>
                <p><strong>Due:</strong> Before next class begins</p>
            </div>
        </div>

        <!-- Slide 36: Grading Rubric -->
        <div class="slide">
            <h1>Grading Rubric</h1>

            <div class="demo-box">
                <table class="table-schema" style="font-size: 0.95em;">
                    <tr>
                        <th>Component</th>
                        <th>Points</th>
                        <th>Criteria</th>
                    </tr>
                    <tr>
                        <td><strong>Part 1: EXPLAIN Analysis</strong></td>
                        <td>30</td>
                        <td>3 queries analyzed (10 pts each): screenshots, written analysis identifying bottlenecks</td>
                    </tr>
                    <tr>
                        <td><strong>Part 2: Implementation</strong></td>
                        <td>40</td>
                        <td>2 views (10 pts each), 3 indexes (10 pts total), before/after EXPLAIN (10 pts)</td>
                    </tr>
                    <tr>
                        <td><strong>Part 3: Measurement</strong></td>
                        <td>30</td>
                        <td>Before screenshots (10), after screenshots (10), comparison table (10)</td>
                    </tr>
                    <tr>
                        <td><strong>Bonus: Advanced</strong></td>
                        <td>+10</td>
                        <td>Trigger or stored procedure implemented and documented</td>
                    </tr>
                </table>
            </div>

            <div class="tip-box">
                <strong>Grading Focus:</strong> Correctness, completeness, clear documentation, real performance improvements
            </div>
        </div>

        <!-- Slide 37: Summary -->
        <div class="slide">
            <h1>Today's Key Takeaways</h1>

            <div class="two-column">
                <div>
                    <h3>Performance Skills:</h3>
                    <ul style="font-size: 1.1em;">
                        <li>Measure API performance with DevTools</li>
                        <li>Analyze queries with EXPLAIN ANALYZE</li>
                        <li>Create indexes to speed up queries</li>
                        <li>Build views to simplify complex JOINs</li>
                        <li>Document before/after improvements</li>
                    </ul>
                </div>
                <div>
                    <h3>Database Objects:</h3>
                    <ul style="font-size: 1.1em;">
                        <li>Triggers for automatic actions</li>
                        <li>Stored procedures for reusable logic</li>
                        <li>Functions for custom calculations</li>
                        <li>Views for data abstraction</li>
                        <li>Query optimization best practices</li>
                    </ul>
                </div>
            </div>

            <div class="netlify-callout" style="margin-top: 30px;">
                <h4>You Can Now:</h4>
                <p style="font-size: 1.15em;">Optimize YOUR live Netlify project for lightning-fast performance! Your users will notice the difference.</p>
            </div>

            <div class="tip-box">
                <strong>Next Lecture:</strong> Database Design Patterns and Advanced Topics
            </div>
        </div>

        <!-- Slide 38: Resources -->
        <div class="slide">
            <h1>Additional Resources</h1>

            <h3>Required Reading:</h3>
            <ul>
                <li>Textbook: Chapters 6-8 (Advanced SQL)</li>
                <li>Textbook: Chapter 11 (Stored Procedures and Triggers)</li>
            </ul>

            <h3>Performance & Optimization:</h3>
            <ul>
                <li>PostgreSQL Documentation - Indexes: <a href="https://www.postgresql.org/docs/current/indexes.html" target="_blank">postgresql.org/docs/current/indexes.html</a></li>
                <li>PostgreSQL Performance Tips: <a href="https://wiki.postgresql.org/wiki/Performance_Optimization" target="_blank">wiki.postgresql.org/wiki/Performance_Optimization</a></li>
                <li>Use The Index, Luke (SQL indexing guide): <a href="https://use-the-index-luke.com/" target="_blank">use-the-index-luke.com</a></li>
                <li>EXPLAIN ANALYZE Tutorial: <a href="https://www.postgresql.org/docs/current/using-explain.html" target="_blank">postgresql.org/docs/current/using-explain.html</a></li>
            </ul>

            <h3>Browser DevTools:</h3>
            <ul>
                <li>Chrome DevTools Network Tab: <a href="https://developer.chrome.com/docs/devtools/network/" target="_blank">developer.chrome.com/docs/devtools/network/</a></li>
                <li>Neon Dashboard Metrics: <a href="https://neon.tech/docs/introduction/monitoring" target="_blank">neon.tech/docs/introduction/monitoring</a></li>
            </ul>

            <h3>Practice Platforms:</h3>
            <ul>
                <li>PostgreSQL Exercises - Performance: <a href="https://pgexercises.com/" target="_blank">pgexercises.com</a></li>
                <li>SQL Performance Explained Book</li>
            </ul>
        </div>

        <!-- Slide 39: Q&A and Discussion -->
        <div class="slide">
            <h1>Questions & Discussion</h1>

            <div style="display: flex; justify-content: center; align-items: center; height: 60%; font-size: 8em;">
                ?
            </div>

            <p style="text-align: center; font-size: 1.5em;">What questions do you have about optimizing YOUR project?</p>

            <div class="info-box" style="margin-top: 40px;">
                <p><strong>Office Hours:</strong> Tuesday & Thursday, 2:00-4:00 PM</p>
                <p><strong>Email:</strong> bobby.reed@okcu.edu</p>
                <p><strong>Course Forum:</strong> Post questions for peer discussion</p>
            </div>
        </div>

        <!-- Slide 40: Next Class Preview -->
        <div class="slide">
            <h1>Next Class: Database Design Patterns</h1>

            <div class="info-box">
                <h3>We'll explore:</h3>
                <ul style="font-size: 1.2em; line-height: 1.8;">
                    <li>Advanced normalization techniques</li>
                    <li>Design patterns for common scenarios</li>
                    <li>Transaction management</li>
                    <li>Database security best practices</li>
                    <li>Scaling strategies</li>
                </ul>
            </div>

            <div class="tip-box">
                <strong>Prepare:</strong> Complete homework optimization and bring questions about performance!
            </div>

            <p style="text-align: center; font-size: 1.5em; margin-top: 40px;">See you next time!</p>
        </div>

        <!-- Navigation Controls -->
        <div class="navigation">
            <button id="prevBtn">Previous</button>
            <span class="slide-counter">
                <span id="currentSlide">1</span> / <span id="totalSlides">41</span>
            </span>
            <button id="nextBtn">Next</button>
        </div>
    </div>

    <!-- Shared Presentation JavaScript -->
    <script src="../../js/presentation.js"></script>

    <!-- Lecture-Specific JavaScript -->
    <script>
        // SQL Part 3 specific interactions
        document.addEventListener('slidechange', (e) => {
            console.log(`Slide ${e.detail.currentSlide + 1} of ${e.detail.totalSlides}`);
        });
    </script>
</body>
</html>
