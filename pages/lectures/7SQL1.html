<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SQL Part 1 - CSCI 5603</title>
    
    <!-- Database Design Presentation Styles with Theme Support -->
    <link rel="stylesheet" href="../../styles/presentation.css">
    <link rel="icon" type="image/x-icon" href="/images/favicon.png">
    
    <!-- Import Courier Prime for analog feel -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Courier+Prime:wght@400;700&family=IBM+Plex+Mono:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Lecture-Specific Styles -->
    <style>
        /* Override font for analog feel */
        body, .slide, h1, h2, h3, p, li {
            font-family: 'Courier Prime', 'IBM Plex Mono', 'Courier New', monospace !important;
        }
        
        /* SQL syntax highlighting classes now in presentation.css */

        .table-schema {
            border-collapse: collapse;
            width: 100%;
            margin: 20px 0;
            font-family: 'IBM Plex Mono', monospace;
        }
        
        .table-schema th {
            background: var(--ocu-true-blue);
            color: white;
            padding: 12px;
            text-align: left;
            font-weight: 600;
        }
        
        .table-schema td {
            border: 1px solid var(--border-color);
            padding: 10px;
            background: var(--bg-secondary);
        }
        
        .table-schema tr:nth-child(even) td {
            background: var(--bg-accent);
        }
        
        .highlight {
            background-color: #ffeb3b;
            color: #000;
            padding: 2px 4px;
            border-radius: 3px;
        }
        
        .activity-timer {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--ocu-green);
            color: white;
            padding: 15px 25px;
            border-radius: 10px;
            font-size: 1.2em;
            display: none;
            z-index: 1000;
        }

        /* Bridge to Your Project boxes */
        .bridge-box {
            background-color: #f0f8ff;
            border-left: 4px solid #4a90e2;
            padding: 15px;
            margin: 20px 0;
            font-family: 'Courier Prime', monospace;
        }

        .bridge-box h4 {
            margin-top: 0;
            color: #4a90e2;
        }

        /* Netlify integration callouts */
        .netlify-callout {
            background-color: #e8f5e9;
            border-left: 4px solid #4caf50;
            padding: 15px;
            margin: 20px 0;
        }

        .netlify-callout h4 {
            margin-top: 0;
            color: #2e7d32;
        }

        /* Project example boxes */
        .project-example {
            background-color: #fff3e0;
            border: 1px solid #ff9800;
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
        }

        .project-example strong {
            color: #e65100;
        }
    </style>
</head>
<body>
    <!-- Theme toggle will be automatically added by JavaScript -->
    
    <div class="presentation-container">
        <!-- Timer display for activities -->
        <div class="timer-display" id="timer-display">
            <span id="timer-text">SQL Part 1 - Data Manipulation
                 <button class="home"><a href="../../index.html">Home</a></button>
            </span>
        </div>

        <!-- Slide 1: Title -->
        <div class="slide active">
            <h1>SQL - Part 1</h1>
            <h2 style="color: var(--ocu-cyan);">Structured Query Language</h2>
            <h3>Data Manipulation</h3>
            <div style="margin-top: 50px;">
                <p><strong>CSCI 5603 - Database Design</strong></p>
                <p>Week 4, Lecture 7</p>
                <p>Instructor: Bobby Reed</p>
            </div>
        </div>

        <!-- Slide 2: Learning Objectives -->
        <div class="slide">
            <h1>Today's Learning Objectives</h1>
            <ul>
                <li>Understand the history and importance of SQL</li>
                <li>Master the basic SELECT statement structure</li>
                <li>Learn to filter data with WHERE clauses</li>
                <li>Sort results using ORDER BY</li>
                <li>Use aggregate functions (COUNT, SUM, AVG, MIN, MAX)</li>
                <li>Group data with GROUP BY and HAVING</li>
                <li>Implement pattern matching with LIKE</li>
                <li>Write effective SQL queries for data retrieval</li>
            </ul>
            <div class="highlight-box" style="margin-top: 30px;">
                <p><strong>Focus:</strong> This lecture covers SQL Data Manipulation Language (DML) - how to retrieve and query data from existing database tables.</p>
            </div>
        </div>

        <!-- Slide 3: Historical Context -->
        <div class="slide">
            <h1>Historical Context <span class="emoji">üìú</span></h1>
            <h2>From SEQUEL to SQL</h2>

            <div class="concept-box">
                <h3>SEQUEL to SQL</h3>
                <p style="font-size: 1.15em; line-height: 1.7;">SEQUEL (Structured English Query Language) was developed for IBM's System R by Don Chamberlin and Raymond Boyce. Due to a trademark conflict, it was renamed SQL (Structured Query Language). SQL was deliberately designed to be more user-friendly than relational calculus while retaining its theoretical power‚Äîmaking database queries accessible to non-mathematicians.</p>
            </div>

            <div class="concept-box">
                <h3>Early Standardization (1986/1987)</h3>
                <p style="font-size: 1.15em; line-height: 1.7;">SQL's rapid adoption led to standardization by ANSI in 1986 and ISO in 1987, cementing its status as the "intergalactic standard" for relational databases. This standardization ensured SQL would work across different database systems, making it the universal language for data management.</p>
            </div>

            <div class="tip-box">
                <strong>Key Insight:</strong> SQL's success came from balancing theoretical rigor with practical usability‚Äîit's powerful enough for complex queries yet simple enough for everyday use.
            </div>
        </div>

        <!-- Slide 4: History of SQL -->
        <div class="slide">
            <h1>History of SQL</h1>
            <h2>The Birth of a Standard</h2>
            <ul>
                <li><strong>1974:</strong> D. Chamberlin (IBM) creates SEQUEL - "Structured English Query Language"</li>
                <li><strong>1976:</strong> SEQUEL/2 defined, renamed to SQL for legal reasons</li>
                <li><strong>Late 1970s:</strong> ORACLE appears as first commercial RDBMS based on SQL</li>
                <li><strong>1987:</strong> ANSI and ISO publish initial SQL standard</li>
                <li><strong>1992:</strong> SQL2/SQL-92 - First major revision</li>
                <li><strong>1999:</strong> SQL:1999 - Object-oriented features</li>
                <li><strong>2003-2019:</strong> Continuous evolution (SQL:2003, 2008, 2011, 2016, 2019)</li>
            </ul>
            <div class="note-box">
                <p><strong>Note:</strong> Still pronounced "see-quel" by many, though official pronunciation is "S-Q-L"</p>
            </div>
        </div>

        <!-- Slide 4: Importance of SQL -->
        <div class="slide">
            <h1>Why SQL Matters</h1>
            <h2>Industry Standard and Beyond</h2>
            <ul>
                <li>Part of major application architectures (IBM's Systems Application Architecture)</li>
                <li>Strategic choice of influential organizations (X/OPEN)</li>
                <li>Federal Information Processing Standard (FIPS)</li>
                <li>Required for all database sales to U.S. Government</li>
                <li>Used in other standards (ISO's IRDS, Remote Data Access)</li>
                <li>De facto standard for relational databases</li>
            </ul>
            <div class="activity-box">
                <h3>üí≠ Discussion (5 min)</h3>
                <p>Why do you think SQL has remained dominant for nearly 50 years while other technologies have come and gone?</p>
            </div>
        </div>

        <!-- Slide 5: SQL Objectives -->
        <div class="slide">
            <h1>Objectives of SQL</h1>
            <h2>Design Philosophy</h2>
            <div class="two-column">
                <div>
                    <h3>Core Capabilities</h3>
                    <ul>
                        <li>Create database and relation structures</li>
                        <li>Perform data insertion</li>
                        <li>Modify existing data</li>
                        <li>Delete data from relations</li>
                        <li>Execute simple and complex queries</li>
                    </ul>
                </div>
                <div>
                    <h3>Key Characteristics</h3>
                    <ul>
                        <li><strong>Non-procedural:</strong> Specify WHAT, not HOW</li>
                        <li><strong>Transform-oriented:</strong> DDL + DML</li>
                        <li><strong>Free-format:</strong> Flexible syntax</li>
                        <li><strong>English-like:</strong> Readable commands</li>
                        <li><strong>Universal:</strong> Used by all user types</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Slide 6: Database Schema -->
        <div class="slide">
            <h1>Our Teaching Database Schema</h1>
            <h2>movie_rental_db - Your Familiar Friend</h2>
            <div class="sql-example">
                <strong>Movies</strong> (<u>movie_id</u>, title, genre, release_year, <em>studio_id</em>)<br>
                <strong>Members</strong> (<u>member_id</u>, name, email, join_date)<br>
                <strong>Rentals</strong> (<u>rental_id</u>, <em>movie_id</em>, <em>member_id</em>, rental_date, return_date)<br>
                <strong>Studios</strong> (<u>studio_id</u>, name, location)
            </div>
            <p><em>Note: Primary keys are underlined, foreign keys are italicized</em></p>

            <div class="netlify-callout" style="margin-top: 30px;">
                <h4>üåê Connection to Your Project</h4>
                <p><strong>Remember:</strong> In Lecture 6, you built a Netlify frontend with API endpoints for YOUR project database. Today's SQL concepts will help you enhance those APIs with filtering, sorting, search, and statistics!</p>
            </div>
        </div>

        <!-- Slide 7: SELECT Statement Structure -->
        <div class="slide">
            <h1>The SELECT Statement</h1>
            <h2>Foundation of SQL Queries</h2>
            <div class="sql-example">
                <span class="sql-keyword">SELECT</span> [<span class="sql-keyword">DISTINCT</span> | <span class="sql-keyword">ALL</span>]
                    { * | [columnExpression [<span class="sql-keyword">AS</span> newName]] [, ...] }<br>
                <span class="sql-keyword">FROM</span> TableName [alias] [, ...]<br>
                [<span class="sql-keyword">WHERE</span> condition]<br>
                [<span class="sql-keyword">GROUP BY</span> columnList] [<span class="sql-keyword">HAVING</span> condition]<br>
                [<span class="sql-keyword">ORDER BY</span> columnList]
            </div>
            <h3>Key Points:</h3>
            <ul>
                <li>Order of clauses cannot be changed</li>
                <li>Only SELECT and FROM are mandatory</li>
                <li>Keywords are RESERVED WORDS</li>
            </ul>
        </div>

        <!-- Slide 8: Basic SELECT Examples -->
        <div class="slide">
            <h1>Basic SELECT Queries</h1>
            <h2>Retrieving All Data</h2>
            <div class="sql-example">
                <span class="sql-keyword">SELECT</span> * <span class="sql-keyword">FROM</span> Movies;
            </div>
            <table class="table-schema">
                <tr>
                    <th>movie_id</th><th>title</th><th>genre</th><th>release_year</th><th>studio_id</th>
                </tr>
                <tr>
                    <td>1</td><td>The Matrix</td><td>Science Fiction</td><td>1999</td><td>1</td>
                </tr>
                <tr>
                    <td>2</td><td>Inception</td><td>Science Fiction</td><td>2010</td><td>1</td>
                </tr>
                <tr>
                    <td>3</td><td>The Godfather</td><td>Drama</td><td>1972</td><td>2</td>
                </tr>
                <tr>
                    <td>4</td><td>Pulp Fiction</td><td>Crime</td><td>1994</td><td>3</td>
                </tr>
            </table>

            <div class="bridge-box" style="margin-top: 30px;">
                <h4>üåâ Bridge to Your Project</h4>
                <p><strong>Try this with YOUR data:</strong></p>
                <p>Replace <code>Movies</code> with one of your project tables. This is the simplest query - it returns ALL rows and ALL columns.</p>
                <div class="project-example">
                    <strong>Recipe database:</strong> <code>SELECT * FROM recipes;</code><br>
                    <strong>Inventory database:</strong> <code>SELECT * FROM products;</code><br>
                    <strong>Library database:</strong> <code>SELECT * FROM books;</code>
                </div>
            </div>
        </div>

        <!-- Slide 9: DISTINCT -->
        <div class="slide">
            <h1>Using DISTINCT</h1>
            <h2>Eliminating Duplicates</h2>
            <p><strong>Problem:</strong> List all unique genres of movies in our database.</p>

            <div class="comparison-table">
                <div>
                    <h3>Without DISTINCT</h3>
                    <div class="sql-example">
                        <span class="sql-keyword">SELECT</span> genre<br>
                        <span class="sql-keyword">FROM</span> Movies;
                    </div>
                    <table class="table-schema">
                        <tr><th>genre</th></tr>
                        <tr><td>Science Fiction</td></tr>
                        <tr><td style="background: #ffeb3b;">Science Fiction</td></tr>
                        <tr><td>Drama</td></tr>
                        <tr><td>Crime</td></tr>
                        <tr><td style="background: #ffeb3b;">Drama</td></tr>
                    </table>
                </div>
                <div>
                    <h3>With DISTINCT</h3>
                    <div class="sql-example">
                        <span class="sql-keyword">SELECT DISTINCT</span> genre<br>
                        <span class="sql-keyword">FROM</span> Movies;
                    </div>
                    <table class="table-schema">
                        <tr><th>genre</th></tr>
                        <tr><td>Science Fiction</td></tr>
                        <tr><td>Drama</td></tr>
                        <tr><td>Crime</td></tr>
                    </table>
                </div>
            </div>

            <div class="bridge-box" style="margin-top: 30px;">
                <h4>üåâ Bridge to Your Project</h4>
                <p><strong>Use DISTINCT to find unique values:</strong></p>
                <div class="project-example">
                    <strong>Recipe database:</strong> <code>SELECT DISTINCT cuisine FROM recipes;</code><br>
                    <strong>Inventory database:</strong> <code>SELECT DISTINCT category FROM products;</code><br>
                    <strong>Library database:</strong> <code>SELECT DISTINCT author FROM books;</code>
                </div>
                <p style="margin-top: 10px;"><strong>Great for:</strong> Populating dropdown filters in your Netlify frontend!</p>
            </div>
        </div>

        <!-- Slide 10: WHERE Clause -->
        <div class="slide">
            <h1>Filtering with WHERE</h1>
            <h2>Conditional Data Retrieval</h2>
            <p><strong>Example:</strong> Find all Science Fiction movies</p>
            <div class="sql-example">
                <span class="sql-keyword">SELECT</span> title, genre, release_year<br>
                <span class="sql-keyword">FROM</span> Movies<br>
                <span class="sql-keyword">WHERE</span> genre = <span class="sql-string">'Science Fiction'</span>;
            </div>

            <h3>Comparison Operators</h3>
            <ul>
                <li><code>=</code> Equal to</li>
                <li><code>&lt;&gt;</code> or <code>!=</code> Not equal to</li>
                <li><code>&lt;</code> Less than</li>
                <li><code>&lt;=</code> Less than or equal to</li>
                <li><code>&gt;</code> Greater than</li>
                <li><code>&gt;=</code> Greater than or equal to</li>
            </ul>

            <div class="netlify-callout" style="margin-top: 30px;">
                <h4>üíª This Powers Your API</h4>
                <p>In your Netlify function from Lecture 6, this WHERE clause becomes a query parameter:</p>
                <p><code>GET /api/movies?genre=Science%20Fiction</code></p>
            </div>
        </div>

        <!-- Slide 11: Activity - Basic Queries -->
        <div class="slide">
            <h1>üéØ Activity: Write Your First Queries</h1>
            <h2>15 Minutes - Individual Work</h2>
            <div class="activity-box">
                <p><strong>Part A: Practice with movie_rental_db</strong></p>
                <ol>
                    <li>List all Drama movies</li>
                    <li>Find all movies released after 2000</li>
                    <li>Show member names and email addresses</li>
                    <li>Find all rentals that have been returned</li>
                </ol>
            </div>
            <div class="bridge-box" style="margin-top: 20px;">
                <h4>Part B: Apply to YOUR Project</h4>
                <p>Write 2-3 WHERE clause queries for your own project database. Think about what filters would be useful in your Netlify frontend!</p>
                <p><strong>Examples:</strong></p>
                <ul style="font-size: 0.95em;">
                    <li>Filter by category/type</li>
                    <li>Filter by date range</li>
                    <li>Filter by numeric value (price, quantity, rating, etc.)</li>
                </ul>
                <button onclick="startTimer(15)">Start Timer</button>
            </div>
        </div>

        <!-- Slide 12: ORDER BY -->
        <div class="slide">
            <h1>Sorting Results with ORDER BY</h1>
            <h2>Single Column Ordering</h2>
            <p><strong>Example:</strong> List movies arranged by release year, newest first</p>
            <div class="sql-example">
                <span class="sql-keyword">SELECT</span> title, genre, release_year<br>
                <span class="sql-keyword">FROM</span> Movies<br>
                <span class="sql-keyword">ORDER BY</span> release_year <span class="sql-keyword">DESC</span>;
            </div>

            <table class="table-schema">
                <tr><th>title</th><th>genre</th><th>release_year</th></tr>
                <tr><td>Inception</td><td>Science Fiction</td><td>2010</td></tr>
                <tr><td>The Matrix</td><td>Science Fiction</td><td>1999</td></tr>
                <tr><td>Pulp Fiction</td><td>Crime</td><td>1994</td></tr>
                <tr><td>The Godfather</td><td>Drama</td><td>1972</td></tr>
            </table>
            <p><em>Note: Default is ASC (ascending), use DESC for descending</em></p>

            <div class="bridge-box" style="margin-top: 20px;">
                <h4>üåâ Bridge to Your Project</h4>
                <p><strong>Sorting makes data useful:</strong></p>
                <div class="project-example">
                    <strong>Recipe database:</strong> <code>ORDER BY prep_time ASC</code> (quickest first)<br>
                    <strong>Inventory database:</strong> <code>ORDER BY price DESC</code> (most expensive first)<br>
                    <strong>Library database:</strong> <code>ORDER BY publication_year DESC</code> (newest first)
                </div>
            </div>
        </div>

        <!-- Slide 13: Aggregate Functions -->
        <div class="slide">
            <h1>Aggregate Functions</h1>
            <h2>Statistical Operations</h2>
            <div class="two-column">
                <div>
                    <h3>Available Functions</h3>
                    <ul>
                        <li><code>COUNT(*)</code> - Number of rows</li>
                        <li><code>COUNT(column)</code> - Non-null values</li>
                        <li><code>SUM(column)</code> - Total of values</li>
                        <li><code>AVG(column)</code> - Average value</li>
                        <li><code>MIN(column)</code> - Minimum value</li>
                        <li><code>MAX(column)</code> - Maximum value</li>
                    </ul>
                </div>
                <div>
                    <h3>Example: Movie Stats</h3>
                    <div class="sql-example">
                        <span class="sql-keyword">SELECT</span>
                            <span class="sql-function">COUNT</span>(*) <span class="sql-keyword">AS</span> total_movies,<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;<span class="sql-function">MIN</span>(release_year) <span class="sql-keyword">AS</span> oldest,<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;<span class="sql-function">MAX</span>(release_year) <span class="sql-keyword">AS</span> newest<br>
                        <span class="sql-keyword">FROM</span> Movies;
                    </div>
                </div>
            </div>
            <div class="note-box">
                <p><strong>Important:</strong> Aggregate functions can only be used in SELECT list and HAVING clause</p>
            </div>
            <div class="netlify-callout" style="margin-top: 20px;">
                <h4>üíª Perfect for Dashboard APIs!</h4>
                <p>Create an API endpoint like <code>GET /api/stats</code> that returns aggregate data for your frontend dashboard.</p>
            </div>
        </div>

        <!-- Slide 14: GROUP BY -->
        <div class="slide">
            <h1>GROUP BY Clause</h1>
            <h2>Grouping for Subtotals</h2>
            <p><strong>Example:</strong> Count how many movies we have in each genre</p>
            <div class="sql-example">
                <span class="sql-keyword">SELECT</span> <span class="highlight">genre</span>,<br>
                &nbsp;&nbsp;&nbsp;&nbsp;<span class="sql-function">COUNT</span>(*) <span class="sql-keyword">AS</span> movie_count<br>
                <span class="sql-keyword">FROM</span> Movies<br>
                <span class="sql-keyword">GROUP BY</span> <span class="highlight">genre</span><br>
                <span class="sql-keyword">ORDER BY</span> movie_count <span class="sql-keyword">DESC</span>;
            </div>

            <table class="table-schema">
                <tr><th>genre</th><th>movie_count</th></tr>
                <tr><td>Science Fiction</td><td>2</td></tr>
                <tr><td>Drama</td><td>1</td></tr>
                <tr><td>Crime</td><td>1</td></tr>
            </table>

            <p><strong>Rule:</strong> All columns in SELECT must either be in GROUP BY or be aggregate functions</p>

            <div class="bridge-box" style="margin-top: 20px;">
                <h4>üåâ Bridge to Your Project</h4>
                <p><strong>GROUP BY creates category breakdowns:</strong></p>
                <div class="project-example">
                    <strong>Recipe database:</strong> <code>SELECT cuisine, COUNT(*) FROM recipes GROUP BY cuisine;</code><br>
                    <strong>Inventory database:</strong> <code>SELECT category, SUM(quantity) FROM products GROUP BY category;</code><br>
                    <strong>Library database:</strong> <code>SELECT genre, COUNT(*) FROM books GROUP BY genre;</code>
                </div>
            </div>
        </div>

        <!-- Slide 15: HAVING Clause -->
        <div class="slide">
            <h1>HAVING Clause</h1>
            <h2>Filtering Grouped Results</h2>
            <p><strong>Example:</strong> Show members who have rented 5 or more movies</p>
            <div class="sql-example">
                <span class="sql-keyword">SELECT</span> member_id,<br>
                &nbsp;&nbsp;&nbsp;&nbsp;<span class="sql-function">COUNT</span>(*) <span class="sql-keyword">AS</span> rental_count<br>
                <span class="sql-keyword">FROM</span> Rentals<br>
                <span class="sql-keyword">GROUP BY</span> member_id<br>
                <span class="sql-keyword">HAVING COUNT</span>(*) >= 5<br>
                <span class="sql-keyword">ORDER BY</span> rental_count <span class="sql-keyword">DESC</span>;
            </div>

            <div class="comparison-table">
                <div>
                    <h3>WHERE vs HAVING</h3>
                    <ul>
                        <li><strong>WHERE:</strong> Filters individual rows</li>
                        <li><strong>HAVING:</strong> Filters groups</li>
                        <li>WHERE comes before GROUP BY</li>
                        <li>HAVING comes after GROUP BY</li>
                    </ul>
                </div>
            </div>

            <div class="bridge-box" style="margin-top: 20px;">
                <h4>üåâ Bridge to Your Project</h4>
                <p><strong>Find "top" categories with HAVING:</strong></p>
                <div class="project-example">
                    <strong>Recipe database:</strong> Popular cuisines with 10+ recipes<br>
                    <strong>Inventory database:</strong> Categories with total value > $5000<br>
                    <strong>Library database:</strong> Authors with 3+ books
                </div>
            </div>
        </div>

        <!-- Slide 16: Pattern Matching -->
        <div class="slide">
            <h1>Pattern Matching with LIKE</h1>
            <h2>Flexible String Searching</h2>

            <h3>Special Pattern Symbols</h3>
            <ul>
                <li><code>%</code> - Zero or more characters</li>
                <li><code>_</code> - Exactly one character</li>
            </ul>

            <h3>Examples with Movies</h3>
            <div class="sql-example">
                <span class="sql-comment">-- Find movies with "The" in the title</span><br>
                <span class="sql-keyword">SELECT</span> title, release_year<br>
                <span class="sql-keyword">FROM</span> Movies<br>
                <span class="sql-keyword">WHERE</span> title <span class="sql-keyword">LIKE</span> <span class="sql-string">'%The%'</span>;<br><br>

                <span class="sql-comment">-- Find members with email ending in .edu</span><br>
                <span class="sql-keyword">SELECT</span> name, email<br>
                <span class="sql-keyword">FROM</span> Members<br>
                <span class="sql-keyword">WHERE</span> email <span class="sql-keyword">LIKE</span> <span class="sql-string">'%.edu'</span>;
            </div>

            <div class="netlify-callout" style="margin-top: 20px;">
                <h4>üíª This Is Your Search Feature!</h4>
                <p>LIKE powers search boxes in your Netlify frontend:</p>
                <p><code>GET /api/search?q=Matrix</code> ‚Üí <code>WHERE title LIKE '%Matrix%'</code></p>
            </div>

            <div class="bridge-box" style="margin-top: 20px;">
                <h4>üåâ Bridge to Your Project</h4>
                <p><strong>Add search to your project:</strong></p>
                <div class="project-example">
                    <strong>Recipe database:</strong> <code>WHERE name LIKE '%chicken%'</code><br>
                    <strong>Inventory database:</strong> <code>WHERE description LIKE '%wireless%'</code><br>
                    <strong>Library database:</strong> <code>WHERE title LIKE '%python%'</code>
                </div>
            </div>
        </div>

        <!-- Slide 17: Writing Good SQL -->
        <div class="slide">
            <h1>Writing Good SQL Commands</h1>
            <h2>Best Practices by Bobby Reed</h2>
            
            <div class="two-column">
                <div>
                    <h3>‚úÖ DO</h3>
                    <ul>
                        <li>Use consistent capitalization for keywords</li>
                        <li>Start each clause on a new line</li>
                        <li>Indent subparts of clauses</li>
                        <li>Use meaningful aliases</li>
                        <li>Comment complex queries</li>
                        <li>Test queries incrementally</li>
                    </ul>
                </div>
                <div>
                    <h3>‚ùå DON'T</h3>
                    <ul>
                        <li>Write everything on one line</li>
                        <li>Use SELECT * in production</li>
                        <li>Forget to handle NULLs</li>
                        <li>Ignore performance implications</li>
                        <li>Mix different formatting styles</li>
                        <li>Use reserved words as names</li>
                    </ul>
                </div>
            </div>
            
            <div class="sql-example">
                <span class="sql-comment">-- Good formatting example</span><br>
                <span class="sql-keyword">SELECT</span> genre,<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql-function">COUNT</span>(*) <span class="sql-keyword">AS</span> total_movies,<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql-function">AVG</span>(release_year) <span class="sql-keyword">AS</span> avg_year<br>
                <span class="sql-keyword">FROM</span> Movies<br>
                <span class="sql-keyword">WHERE</span> release_year >= 2000<br>
                <span class="sql-keyword">GROUP BY</span> genre<br>
                <span class="sql-keyword">HAVING COUNT</span>(*) > 1<br>
                <span class="sql-keyword">ORDER BY</span> total_movies <span class="sql-keyword">DESC</span>;
            </div>
        </div>

        <!-- NEW SECTION: SQL Powers Your Netlify API -->

        <!-- Slide 17a: SQL Powers Your Netlify API -->
        <div class="slide">
            <h1>SQL Powers Your Netlify API</h1>
            <h2>Connecting Lecture 6 to Lecture 7</h2>

            <div class="netlify-callout">
                <h4>üåê Remember Lecture 6?</h4>
                <p>You built a live Netlify frontend with API endpoints for your project database. Today's SQL concepts make those APIs much more powerful!</p>
            </div>

            <h3 style="margin-top: 30px;">The Pattern:</h3>
            <div class="demo-box">
                <ol style="font-size: 1.1em; line-height: 1.8;">
                    <li><strong>Learn SQL concept</strong> with movie_rental_db examples</li>
                    <li><strong>Adapt to YOUR project</strong> database schema</li>
                    <li><strong>Add to Netlify function</strong> as a new API endpoint</li>
                    <li><strong>Update frontend</strong> to call and display the results</li>
                </ol>
            </div>

            <div class="tip-box" style="margin-top: 30px;">
                <p><strong>By the end of today:</strong> Your project will have filtering, sorting, search, and dashboard statistics - all powered by SQL!</p>
            </div>
        </div>

        <!-- Slide 17b: WHERE Becomes Query Parameters -->
        <div class="slide">
            <h1>WHERE Clause ‚Üí Query Parameters</h1>
            <h2>Filtering Data via API</h2>

            <div class="two-column">
                <div>
                    <h3>SQL Query</h3>
                    <div class="sql-example" style="font-size: 0.9em;">
                        <span class="sql-keyword">SELECT</span> *<br>
                        <span class="sql-keyword">FROM</span> Movies<br>
                        <span class="sql-keyword">WHERE</span> genre = <span class="sql-string">'Drama'</span>;
                    </div>
                </div>
                <div>
                    <h3>API Call</h3>
                    <div class="sql-example" style="font-size: 0.9em;">
                        GET /api/movies?genre=Drama
                    </div>
                </div>
            </div>

            <h3 style="margin-top: 30px;">Netlify Function Code:</h3>
            <div class="sql-example" style="font-size: 0.85em;">
                <span class="sql-keyword">exports.handler</span> = <span class="sql-keyword">async</span> (event, context) => {<br>
                &nbsp;&nbsp;<span class="sql-keyword">const</span> { genre } = event.queryStringParameters || {};<br><br>

                &nbsp;&nbsp;<span class="sql-keyword">let</span> query = <span class="sql-string">'SELECT * FROM Movies'</span>;<br>
                &nbsp;&nbsp;<span class="sql-keyword">const</span> params = [];<br><br>

                &nbsp;&nbsp;<span class="sql-keyword">if</span> (genre) {<br>
                &nbsp;&nbsp;&nbsp;&nbsp;params.push(genre);<br>
                &nbsp;&nbsp;&nbsp;&nbsp;query += <span class="sql-string">' WHERE genre = $1'</span>;<br>
                &nbsp;&nbsp;}<br><br>

                &nbsp;&nbsp;<span class="sql-keyword">const</span> result = <span class="sql-keyword">await</span> pool.query(query, params);<br>
                &nbsp;&nbsp;<span class="sql-keyword">return</span> { statusCode: 200, body: JSON.stringify(result.rows) };<br>
                };
            </div>
        </div>

        <!-- Slide 17c: ORDER BY Becomes Sort Parameters -->
        <div class="slide">
            <h1>ORDER BY ‚Üí Sort Parameters</h1>
            <h2>Letting Users Control Sort Order</h2>

            <div class="netlify-callout">
                <h4>üí° User Experience Tip</h4>
                <p>Let your frontend users choose how to sort results. Common patterns: "Sort by: Date | Price | Name"</p>
            </div>

            <h3 style="margin-top: 20px;">Netlify Function with Safe Sorting:</h3>
            <div class="sql-example" style="font-size: 0.8em;">
                <span class="sql-keyword">exports.handler</span> = <span class="sql-keyword">async</span> (event, context) => {<br>
                &nbsp;&nbsp;<span class="sql-keyword">const</span> { sortBy, order } = event.queryStringParameters || {};<br><br>

                &nbsp;&nbsp;<span class="sql-comment">// IMPORTANT: Whitelist valid sort columns (prevent SQL injection)</span><br>
                &nbsp;&nbsp;<span class="sql-keyword">const</span> validSorts = [<span class="sql-string">'release_year'</span>, <span class="sql-string">'title'</span>, <span class="sql-string">'genre'</span>];<br>
                &nbsp;&nbsp;<span class="sql-keyword">const</span> validOrders = [<span class="sql-string">'ASC'</span>, <span class="sql-string">'DESC'</span>];<br><br>

                &nbsp;&nbsp;<span class="sql-keyword">const</span> sortColumn = validSorts.includes(sortBy) ? sortBy : <span class="sql-string">'release_year'</span>;<br>
                &nbsp;&nbsp;<span class="sql-keyword">const</span> sortOrder = validOrders.includes(order?.toUpperCase()) ? order.toUpperCase() : <span class="sql-string">'DESC'</span>;<br><br>

                &nbsp;&nbsp;<span class="sql-keyword">const</span> query = <span class="sql-string">`SELECT * FROM Movies ORDER BY ${sortColumn} ${sortOrder}`</span>;<br>
                &nbsp;&nbsp;<span class="sql-keyword">const</span> result = <span class="sql-keyword">await</span> pool.query(query);<br><br>

                &nbsp;&nbsp;<span class="sql-keyword">return</span> { statusCode: 200, body: JSON.stringify(result.rows) };<br>
                };
            </div>

            <p style="margin-top: 15px;"><strong>API Call:</strong> <code>GET /api/movies?sortBy=release_year&order=DESC</code></p>
        </div>

        <!-- Slide 17d: Aggregates Become Dashboard APIs -->
        <div class="slide">
            <h1>Aggregates ‚Üí Dashboard Statistics</h1>
            <h2>Powering Admin Panels and Dashboards</h2>

            <div class="netlify-callout">
                <h4>üìä Perfect Use Case</h4>
                <p>Create a <code>/api/stats</code> endpoint that returns high-level metrics for your dashboard page.</p>
            </div>

            <h3>Dashboard Stats Endpoint:</h3>
            <div class="sql-example" style="font-size: 0.8em;">
                <span class="sql-keyword">exports.handler</span> = <span class="sql-keyword">async</span> (event, context) => {<br>
                &nbsp;&nbsp;<span class="sql-keyword">const</span> query = <span class="sql-string">`<br>
                &nbsp;&nbsp;&nbsp;&nbsp;SELECT<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COUNT(DISTINCT genre) as total_genres,<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COUNT(*) as total_movies,<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MIN(release_year) as oldest_movie_year,<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MAX(release_year) as newest_movie_year<br>
                &nbsp;&nbsp;&nbsp;&nbsp;FROM Movies<br>
                &nbsp;&nbsp;`</span>;<br><br>

                &nbsp;&nbsp;<span class="sql-keyword">const</span> result = <span class="sql-keyword">await</span> pool.query(query);<br>
                &nbsp;&nbsp;<span class="sql-keyword">return</span> {<br>
                &nbsp;&nbsp;&nbsp;&nbsp;statusCode: 200,<br>
                &nbsp;&nbsp;&nbsp;&nbsp;body: JSON.stringify(result.rows[0])<br>
                &nbsp;&nbsp;};<br>
                };
            </div>

            <h3 style="margin-top: 20px;">Frontend Display:</h3>
            <div class="project-example">
                <strong>Dashboard cards showing:</strong><br>
                Total Genres: 3 | Total Movies: 150 | Collection: 1972-2024
            </div>
        </div>

        <!-- Slide 17e: GROUP BY Becomes Category Breakdown APIs -->
        <div class="slide">
            <h1>GROUP BY ‚Üí Category Breakdown</h1>
            <h2>Analytics by Category</h2>

            <div class="netlify-callout">
                <h4>üìà Analytics Gold</h4>
                <p>GROUP BY queries power charts, graphs, and category breakdowns in your frontend.</p>
            </div>

            <h3>Movies by Genre Endpoint:</h3>
            <div class="sql-example" style="font-size: 0.85em;">
                <span class="sql-keyword">exports.handler</span> = <span class="sql-keyword">async</span> (event, context) => {<br>
                &nbsp;&nbsp;<span class="sql-keyword">const</span> query = <span class="sql-string">`<br>
                &nbsp;&nbsp;&nbsp;&nbsp;SELECT genre,<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COUNT(*) as movie_count<br>
                &nbsp;&nbsp;&nbsp;&nbsp;FROM Movies<br>
                &nbsp;&nbsp;&nbsp;&nbsp;GROUP BY genre<br>
                &nbsp;&nbsp;&nbsp;&nbsp;ORDER BY movie_count DESC<br>
                &nbsp;&nbsp;`</span>;<br><br>

                &nbsp;&nbsp;<span class="sql-keyword">const</span> result = <span class="sql-keyword">await</span> pool.query(query);<br>
                &nbsp;&nbsp;<span class="sql-keyword">return</span> { statusCode: 200, body: JSON.stringify(result.rows) };<br>
                };
            </div>

            <h3 style="margin-top: 20px;">Returns JSON like:</h3>
            <div class="sql-example" style="font-size: 0.9em;">
                [<br>
                &nbsp;&nbsp;{ "genre": "Science Fiction", "movie_count": 2 },<br>
                &nbsp;&nbsp;{ "genre": "Drama", "movie_count": 1 },<br>
                &nbsp;&nbsp;{ "genre": "Crime", "movie_count": 1 }<br>
                ]
            </div>

            <p style="margin-top: 15px;"><strong>Frontend:</strong> Display as bar chart, pie chart, or simple list</p>
        </div>

        <!-- Slide 17f: LIKE Becomes Search -->
        <div class="slide">
            <h1>LIKE ‚Üí Search Functionality</h1>
            <h2>The Foundation of Every Search Box</h2>

            <div class="netlify-callout">
                <h4>üîç User Expectation</h4>
                <p>Users expect to search your data. LIKE makes it possible with simple pattern matching.</p>
            </div>

            <h3>Search Endpoint:</h3>
            <div class="sql-example" style="font-size: 0.8em;">
                <span class="sql-keyword">exports.handler</span> = <span class="sql-keyword">async</span> (event, context) => {<br>
                &nbsp;&nbsp;<span class="sql-keyword">const</span> { q } = event.queryStringParameters || {};<br><br>

                &nbsp;&nbsp;<span class="sql-keyword">if</span> (!q) {<br>
                &nbsp;&nbsp;&nbsp;&nbsp;<span class="sql-keyword">return</span> {<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;statusCode: 400,<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;body: JSON.stringify({ error: <span class="sql-string">'Search query required'</span> })<br>
                &nbsp;&nbsp;&nbsp;&nbsp;};<br>
                &nbsp;&nbsp;}<br><br>

                &nbsp;&nbsp;<span class="sql-comment">// Use ILIKE for case-insensitive search (PostgreSQL)</span><br>
                &nbsp;&nbsp;<span class="sql-keyword">const</span> query = <span class="sql-string">`<br>
                &nbsp;&nbsp;&nbsp;&nbsp;SELECT * FROM Movies<br>
                &nbsp;&nbsp;&nbsp;&nbsp;WHERE title ILIKE $1<br>
                &nbsp;&nbsp;&nbsp;&nbsp;ORDER BY release_year DESC<br>
                &nbsp;&nbsp;`</span>;<br><br>

                &nbsp;&nbsp;<span class="sql-keyword">const</span> searchPattern = <span class="sql-string">`%${q}%`</span>;<br>
                &nbsp;&nbsp;<span class="sql-keyword">const</span> result = <span class="sql-keyword">await</span> pool.query(query, [searchPattern]);<br><br>

                &nbsp;&nbsp;<span class="sql-keyword">return</span> { statusCode: 200, body: JSON.stringify(result.rows) };<br>
                };
            </div>

            <p style="margin-top: 15px;"><strong>API Call:</strong> <code>GET /api/search?q=Matrix</code></p>
        </div>

        <!-- Slide 18: Complex Query Activity -->
        <div class="slide">
            <h1>üéØ Activity: Plan Your API Enhancements</h1>
            <h2>20 Minutes - Individual Work</h2>
            <div class="activity-box">
                <p><strong>Goal:</strong> Plan 3-5 new API endpoints for YOUR project using today's SQL concepts.</p>

                <h3>For Each Endpoint, Specify:</h3>
                <ol style="font-size: 1.05em; line-height: 1.7;">
                    <li><strong>Endpoint URL:</strong> e.g., <code>GET /api/recipes-by-cuisine?cuisine=Italian</code></li>
                    <li><strong>SQL Query:</strong> What query will power it?</li>
                    <li><strong>Purpose:</strong> What feature does this enable in your frontend?</li>
                </ol>
            </div>

            <div class="bridge-box" style="margin-top: 20px;">
                <h4>Endpoint Ideas:</h4>
                <ul style="font-size: 0.95em;">
                    <li>‚úÖ <strong>Filter endpoint:</strong> Filter by category/type (uses WHERE)</li>
                    <li>‚úÖ <strong>Sort endpoint:</strong> Sortable list (uses ORDER BY)</li>
                    <li>‚úÖ <strong>Search endpoint:</strong> Search by keyword (uses LIKE)</li>
                    <li>‚úÖ <strong>Stats endpoint:</strong> Dashboard metrics (uses aggregates)</li>
                    <li>‚úÖ <strong>Category breakdown:</strong> Group by category (uses GROUP BY)</li>
                </ul>
                <button onclick="startTimer(20)">Start Timer</button>
            </div>
        </div>

        <!-- Slide 19: Common Pitfalls -->
        <div class="slide">
            <h1>Common SQL Pitfalls</h1>
            <h2>Learn from Others' Mistakes</h2>
            
            <h3>1. Forgetting GROUP BY</h3>
            <div class="sql-example">
                <span class="sql-comment">-- ‚ùå WRONG: Missing GROUP BY</span><br>
                <span class="sql-keyword">SELECT</span> branchNo, <span class="sql-function">COUNT</span>(*)<br>
                <span class="sql-keyword">FROM</span> Staff;<br><br>
                
                <span class="sql-comment">-- ‚úÖ CORRECT:</span><br>
                <span class="sql-keyword">SELECT</span> branchNo, <span class="sql-function">COUNT</span>(*)<br>
                <span class="sql-keyword">FROM</span> Staff<br>
                <span class="sql-keyword">GROUP BY</span> branchNo;
            </div>
            
            <h3>2. Wrong Clause Order</h3>
            <div class="sql-example">
                <span class="sql-comment">-- ‚ùå WRONG: ORDER BY before WHERE</span><br>
                <span class="sql-keyword">SELECT</span> * <span class="sql-keyword">FROM</span> Staff<br>
                <span class="sql-keyword">ORDER BY</span> salary<br>
                <span class="sql-keyword">WHERE</span> salary > 10000;<br><br>
                
                <span class="sql-comment">-- ‚úÖ CORRECT:</span><br>
                <span class="sql-keyword">SELECT</span> * <span class="sql-keyword">FROM</span> Staff<br>
                <span class="sql-keyword">WHERE</span> salary > 10000<br>
                <span class="sql-keyword">ORDER BY</span> salary;
            </div>
        </div>

        <!-- Slide 20: Performance Tips -->
        <div class="slide">
            <h1>Performance Considerations</h1>
            <h2>Writing Efficient Queries</h2>
            
            <div class="highlight-box">
                <h3>üöÄ Quick Performance Tips</h3>
                <ul>
                    <li><strong>Be Specific:</strong> Select only columns you need, not SELECT *</li>
                    <li><strong>Filter Early:</strong> Use WHERE to reduce data before grouping</li>
                    <li><strong>Index Awareness:</strong> Filters on indexed columns are faster</li>
                    <li><strong>Limit Results:</strong> Use LIMIT/TOP when testing queries</li>
                    <li><strong>Avoid Wildcards at Start:</strong> LIKE '%text' is slower than LIKE 'text%'</li>
                </ul>
            </div>
            
            <h3>Example: Improving Query Performance</h3>
            <div class="sql-example">
                <span class="sql-comment">-- Slower: Gets all columns, wildcard at start</span><br>
                <span class="sql-keyword">SELECT</span> *<br>
                <span class="sql-keyword">FROM</span> Movies<br>
                <span class="sql-keyword">WHERE</span> title <span class="sql-keyword">LIKE</span> <span class="sql-string">'%Matrix%'</span>;<br><br>

                <span class="sql-comment">-- Faster: Specific columns, wildcard at end</span><br>
                <span class="sql-keyword">SELECT</span> movie_id, title, release_year<br>
                <span class="sql-keyword">FROM</span> Movies<br>
                <span class="sql-keyword">WHERE</span> title <span class="sql-keyword">LIKE</span> <span class="sql-string">'Matrix%'</span>;
            </div>

            <div class="netlify-callout" style="margin-top: 20px;">
                <h4>üí° API Performance Matters</h4>
                <p>Slow queries = slow API = frustrated users. Use EXPLAIN to analyze your Netlify function queries!</p>
            </div>
        </div>

        <!-- Slide 21: Preview of Joins -->
        <div class="slide">
            <h1>Preview: Joining Tables</h1>
            <h2>Coming Next Lecture</h2>
            <p>So far, we've queried single tables. Real power comes from combining data:</p>

            <div class="sql-example">
                <span class="sql-comment">-- Example: Show movies with their studio names</span><br>
                <span class="sql-keyword">SELECT</span> m.title, m.genre, s.name <span class="sql-keyword">AS</span> studio_name<br>
                <span class="sql-keyword">FROM</span> Movies m<br>
                <span class="sql-keyword">INNER JOIN</span> Studios s <span class="sql-keyword">ON</span> m.studio_id = s.studio_id;
            </div>

            <h3>Types of Joins We'll Cover:</h3>
            <ul>
                <li><strong>INNER JOIN:</strong> Matching rows from both tables</li>
                <li><strong>LEFT JOIN:</strong> All rows from left table</li>
                <li><strong>RIGHT JOIN:</strong> All rows from right table</li>
                <li><strong>FULL OUTER JOIN:</strong> All rows from both tables</li>
                <li><strong>CROSS JOIN:</strong> Cartesian product</li>
            </ul>

            <div class="netlify-callout" style="margin-top: 20px;">
                <h4>üíª Why Joins Matter for Your API</h4>
                <p>JOINs let your API return rich, related data in one request instead of requiring multiple API calls from your frontend!</p>
            </div>
        </div>

        <!-- IN-CLASS EXERCISES -->

        <!-- Slide 22: Exercise Overview -->
        <div class="slide">
            <h1>In-Class Exercises <span class="emoji">üèóÔ∏è</span></h1>
            <h2>Enhance Your Netlify APIs</h2>

            <div class="netlify-callout">
                <h3>Goal: Level Up Your Project</h3>
                <p style="font-size: 1.15em;">Take the Netlify frontend you built in Lecture 6 and add powerful new features using today's SQL concepts!</p>
            </div>

            <div class="activity-box">
                <h3>What You'll Build:</h3>
                <ul style="font-size: 1.15em;">
                    <li>‚úÖ <strong>Exercise 1:</strong> Add filtering and sorting endpoints</li>
                    <li>‚úÖ <strong>Exercise 2:</strong> Create a dashboard stats endpoint</li>
                    <li>‚úÖ <strong>Exercise 3:</strong> Implement search functionality</li>
                </ul>
            </div>

            <div class="tip-box" style="margin-top: 20px;">
                <p><strong>By the end:</strong> Your project will have professional features like search, filtering, and analytics!</p>
            </div>
        </div>

        <!-- Slide 23: Exercise 1 - Part A -->
        <div class="slide">
            <h1>Exercise 1A: Filter Endpoint</h1>
            <h2>Individual Exercise (15 minutes)</h2>

            <div class="activity-box">
                <h3>Task:</h3>
                <p style="font-size: 1.1em;">Create a new Netlify API endpoint that <strong>filters</strong> your data by one category/field.</p>
            </div>

            <div class="demo-box">
                <h3>Example: Recipe Database</h3>
                <p><strong>Endpoint:</strong> <code>/api/recipes-by-cuisine.js</code></p>
                <p><strong>URL:</strong> <code>GET /api/recipes-by-cuisine?cuisine=Italian</code></p>
                <p><strong>SQL Query:</strong></p>
                <div class="sql-example" style="font-size: 0.9em;">
                    <span class="sql-keyword">SELECT</span> * <span class="sql-keyword">FROM</span> recipes<br>
                    <span class="sql-keyword">WHERE</span> cuisine = $1<br>
                    <span class="sql-keyword">ORDER BY</span> name <span class="sql-keyword">ASC</span>;
                </div>
            </div>

            <div class="bridge-box">
                <h4>Your Turn:</h4>
                <ol style="font-size: 1.05em;">
                    <li>Create new file: <code>netlify/functions/filter-by-[field].js</code></li>
                    <li>Accept query parameter for filtering</li>
                    <li>Use parameterized query with WHERE clause</li>
                    <li>Test with: <code>netlify dev</code></li>
                </ol>
            </div>

            <button data-timer="15">Start 15-Minute Timer</button>
        </div>

        <!-- Slide 24: Exercise 1 - Part B -->
        <div class="slide">
            <h1>Exercise 1B: Add Sorting</h1>
            <h2>Individual Exercise (15 minutes)</h2>

            <div class="activity-box">
                <h3>Task:</h3>
                <p style="font-size: 1.1em;">Enhance the filter endpoint to accept <strong>sort</strong> parameters.</p>
            </div>

            <div class="demo-box">
                <h3>Code Template:</h3>
                <div class="sql-example" style="font-size: 0.8em;">
                    <span class="sql-keyword">const</span> { Pool } = require(<span class="sql-string">'pg'</span>);<br>
                    <span class="sql-keyword">const</span> pool = <span class="sql-keyword">new</span> Pool({ connectionString: process.env.DATABASE_URL });<br><br>

                    <span class="sql-keyword">exports.handler</span> = <span class="sql-keyword">async</span> (event, context) => {<br>
                    &nbsp;&nbsp;<span class="sql-keyword">const</span> { category, sortBy, order } = event.queryStringParameters || {};<br><br>

                    &nbsp;&nbsp;<span class="sql-comment">// IMPORTANT: Whitelist valid sort columns</span><br>
                    &nbsp;&nbsp;<span class="sql-keyword">const</span> validSorts = [<span class="sql-string">'name'</span>, <span class="sql-string">'date'</span>, <span class="sql-string">'price'</span>];<br>
                    &nbsp;&nbsp;<span class="sql-keyword">const</span> validOrders = [<span class="sql-string">'ASC'</span>, <span class="sql-string">'DESC'</span>];<br><br>

                    &nbsp;&nbsp;<span class="sql-keyword">const</span> sortColumn = validSorts.includes(sortBy) ? sortBy : <span class="sql-string">'name'</span>;<br>
                    &nbsp;&nbsp;<span class="sql-keyword">const</span> sortOrder = validOrders.includes(order?.toUpperCase()) ? order : <span class="sql-string">'ASC'</span>;<br><br>

                    &nbsp;&nbsp;<span class="sql-keyword">const</span> query = <span class="sql-string">`SELECT * FROM your_table WHERE category = $1 ORDER BY ${sortColumn} ${sortOrder}`</span>;<br>
                    &nbsp;&nbsp;<span class="sql-keyword">const</span> result = <span class="sql-keyword">await</span> pool.query(query, [category]);<br><br>

                    &nbsp;&nbsp;<span class="sql-keyword">return</span> { statusCode: 200, body: JSON.stringify(result.rows) };<br>
                    };
                </div>
            </div>

            <button data-timer="15">Start 15-Minute Timer</button>
        </div>

        <!-- Slide 25: Exercise 2 -->
        <div class="slide">
            <h1>Exercise 2: Dashboard Stats Endpoint</h1>
            <h2>Individual Exercise (20 minutes)</h2>

            <div class="activity-box">
                <h3>Task:</h3>
                <p style="font-size: 1.1em;">Create an API endpoint that returns <strong>aggregate statistics</strong> for a dashboard.</p>
            </div>

            <div class="demo-box">
                <h3>Example Stats to Calculate:</h3>
                <ul style="font-size: 1.05em;">
                    <li>Total count of records: <code>COUNT(*)</code></li>
                    <li>Average of numeric field: <code>AVG(field)</code></li>
                    <li>Min/Max values: <code>MIN(field), MAX(field)</code></li>
                    <li>Group counts: <code>COUNT(*) ... GROUP BY category</code></li>
                </ul>
            </div>

            <div class="bridge-box">
                <h4>Implementation Steps:</h4>
                <ol style="font-size: 1.05em;">
                    <li>Create <code>/api/stats.js</code> endpoint</li>
                    <li>Write SQL query with aggregate functions</li>
                    <li>Return JSON with statistics</li>
                    <li>Test the endpoint</li>
                    <li><strong>Bonus:</strong> Display stats in your frontend HTML</li>
                </ol>
            </div>

            <button data-timer="20">Start 20-Minute Timer</button>
        </div>

        <!-- Slide 26: Exercise 3 -->
        <div class="slide">
            <h1>Exercise 3: Search Endpoint</h1>
            <h2>Individual Exercise (20 minutes)</h2>

            <div class="activity-box">
                <h3>Task:</h3>
                <p style="font-size: 1.1em;">Implement a <strong>search</strong> endpoint using LIKE for pattern matching.</p>
            </div>

            <div class="demo-box">
                <h3>Search Template:</h3>
                <div class="sql-example" style="font-size: 0.8em;">
                    <span class="sql-keyword">exports.handler</span> = <span class="sql-keyword">async</span> (event, context) => {<br>
                    &nbsp;&nbsp;<span class="sql-keyword">const</span> { q } = event.queryStringParameters || {};<br><br>

                    &nbsp;&nbsp;<span class="sql-keyword">if</span> (!q) {<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;<span class="sql-keyword">return</span> { statusCode: 400, body: JSON.stringify({ error: <span class="sql-string">'Search query required'</span> }) };<br>
                    &nbsp;&nbsp;}<br><br>

                    &nbsp;&nbsp;<span class="sql-comment">// Use ILIKE for case-insensitive (PostgreSQL)</span><br>
                    &nbsp;&nbsp;<span class="sql-keyword">const</span> query = <span class="sql-string">`SELECT * FROM your_table WHERE name ILIKE $1 ORDER BY name`</span>;<br>
                    &nbsp;&nbsp;<span class="sql-keyword">const</span> searchPattern = <span class="sql-string">`%${q}%`</span>;<br><br>

                    &nbsp;&nbsp;<span class="sql-keyword">const</span> result = <span class="sql-keyword">await</span> pool.query(query, [searchPattern]);<br>
                    &nbsp;&nbsp;<span class="sql-keyword">return</span> { statusCode: 200, body: JSON.stringify(result.rows) };<br>
                    };
                </div>
            </div>

            <div class="bridge-box">
                <h4>Your Turn:</h4>
                <ol style="font-size: 1.05em;">
                    <li>Create <code>/api/search.js</code></li>
                    <li>Accept <code>q</code> query parameter</li>
                    <li>Search 1-2 text fields in your table</li>
                    <li><strong>Bonus:</strong> Add search box to your frontend!</li>
                </ol>
            </div>

            <button data-timer="20">Start 20-Minute Timer</button>
        </div>

        <!-- Slide 27: Exercise Wrap-Up -->
        <div class="slide">
            <h1>Exercise Wrap-Up</h1>
            <h2>What You've Accomplished</h2>

            <div class="netlify-callout">
                <h3>üéâ Your Project Now Has:</h3>
                <ul style="font-size: 1.15em; line-height: 1.8;">
                    <li>‚úÖ <strong>Filtering:</strong> Users can filter by category/type</li>
                    <li>‚úÖ <strong>Sorting:</strong> Sortable lists by different fields</li>
                    <li>‚úÖ <strong>Dashboard:</strong> Aggregate statistics at a glance</li>
                    <li>‚úÖ <strong>Search:</strong> Users can search your data</li>
                </ul>
            </div>

            <div class="tip-box" style="margin-top: 30px;">
                <h3>üí° Next Steps (Optional)</h3>
                <ul style="font-size: 1.05em;">
                    <li>Add a GROUP BY endpoint for category breakdowns</li>
                    <li>Implement pagination with LIMIT and OFFSET</li>
                    <li>Create a "top 10" endpoint with ORDER BY + LIMIT</li>
                    <li>Update your frontend UI to use these new endpoints</li>
                </ul>
            </div>

            <div class="demo-box" style="margin-top: 20px;">
                <h3>Testing Your APIs:</h3>
                <p>Run <code>netlify dev</code> and visit:</p>
                <ul style="font-family: monospace; font-size: 0.95em;">
                    <li>http://localhost:8888/api/filter-by-category?category=value</li>
                    <li>http://localhost:8888/api/stats</li>
                    <li>http://localhost:8888/api/search?q=keyword</li>
                </ul>
            </div>
        </div>

        <!-- Slide 28: Deployment -->
        <div class="slide">
            <h1>Deploy Your Enhanced Project</h1>
            <h2>Share Your Work!</h2>

            <div class="netlify-callout">
                <h3>üöÄ Ready to Deploy?</h3>
                <p style="font-size: 1.1em;">If your exercises are working locally, push to GitHub to deploy to Netlify!</p>
            </div>

            <div class="demo-box">
                <h3>Deployment Steps:</h3>
                <ol style="font-size: 1.1em; line-height: 1.8;">
                    <li><strong>Test locally:</strong> <code>netlify dev</code></li>
                    <li><strong>Commit changes:</strong> <code>git add . && git commit -m "Add filtering, stats, and search APIs"</code></li>
                    <li><strong>Push to GitHub:</strong> <code>git push origin main</code></li>
                    <li><strong>Auto-deploy:</strong> Netlify automatically builds and deploys</li>
                    <li><strong>Test live:</strong> Visit your Netlify URL</li>
                </ol>
            </div>

            <div class="warning-box" style="margin-top: 20px;">
                <h3>‚ö†Ô∏è Before Deploying:</h3>
                <ul style="font-size: 1.05em;">
                    <li>Verify DATABASE_URL environment variable is set in Netlify</li>
                    <li>Test all endpoints work locally</li>
                    <li>Check for console errors</li>
                </ul>
            </div>
        </div>

        <!-- HOMEWORK SECTION -->

        <!-- Slide 29: Homework Overview -->
        <div class="slide">
            <h1>Homework Assignment <span class="emoji">üìù</span></h1>
            <h2>Week 7: Enhance Your Project APIs</h2>

            <div class="netlify-callout">
                <h3>Assignment Overview</h3>
                <p style="font-size: 1.15em;">Build on your Netlify project by implementing advanced SQL queries and analyzing their performance.</p>
            </div>

            <div class="tip-box">
                <h3>Due Date: <strong>Before Class Next Week</strong></h3>
                <p>Submit live Netlify URL + GitHub commit URL to D2L</p>
            </div>

            <div class="activity-box">
                <h3>Components:</h3>
                <ol style="font-size: 1.15em; line-height: 1.8;">
                    <li><strong>Part 1:</strong> Implement 5+ Advanced SQL Queries (40 points)</li>
                    <li><strong>Part 2:</strong> Create 3 New API Endpoints (40 points)</li>
                    <li><strong>Part 3:</strong> EXPLAIN Analysis & Optimization (20 points)</li>
                </ol>
                <p style="margin-top: 15px; font-size: 1.1em;"><strong>Total: 100 points</strong></p>
            </div>
        </div>

        <!-- Slide 30: Part 1 - Advanced Queries -->
        <div class="slide">
            <h1>Part 1: Write Advanced SQL Queries</h1>
            <h2>40 Points</h2>

            <div class="activity-box">
                <h3>Task:</h3>
                <p style="font-size: 1.15em;">Write <strong>5+ SQL queries</strong> for your project database demonstrating different concepts from today's lecture.</p>
            </div>

            <div class="demo-box">
                <h3>Required Query Types:</h3>
                <ol style="font-size: 1.05em; line-height: 1.8;">
                    <li><strong>Filtered Query:</strong> WHERE with 2+ conditions (using AND/OR)</li>
                    <li><strong>Sorted Query:</strong> ORDER BY on at least one column</li>
                    <li><strong>Search Query:</strong> LIKE for pattern matching</li>
                    <li><strong>Aggregate Query:</strong> COUNT, SUM, AVG, MIN, or MAX</li>
                    <li><strong>Grouped Query:</strong> GROUP BY with aggregate + HAVING clause</li>
                </ol>
            </div>

            <div class="bridge-box">
                <h4>Deliverable:</h4>
                <p>Create a file <code>homework_queries.sql</code> with all 5+ queries, each with:</p>
                <ul style="font-size: 1.05em;">
                    <li>Comment explaining what the query does</li>
                    <li>The SQL query itself</li>
                    <li>Sample output (copy/paste or screenshot)</li>
                </ul>
            </div>
        </div>

        <!-- Slide 31: Part 2 - API Endpoints -->
        <div class="slide">
            <h1>Part 2: Implement API Endpoints</h1>
            <h2>40 Points</h2>

            <div class="activity-box">
                <h3>Task:</h3>
                <p style="font-size: 1.15em;">Create <strong>3 new Netlify API endpoints</strong> using queries from Part 1.</p>
            </div>

            <div class="demo-box">
                <h3>Requirements:</h3>
                <ol style="font-size: 1.05em; line-height: 1.8;">
                    <li><strong>Endpoint 1: Filter + Sort</strong>
                        <ul style="margin-top: 8px;">
                            <li>Accept query parameters for filtering and sorting</li>
                            <li>Use parameterized queries (prevent SQL injection)</li>
                            <li>Example: <code>/api/items-by-category?category=value&sortBy=name&order=ASC</code></li>
                        </ul>
                    </li>
                    <li><strong>Endpoint 2: Dashboard Stats</strong>
                        <ul style="margin-top: 8px;">
                            <li>Return aggregate statistics as JSON</li>
                            <li>Use COUNT, AVG, MIN, MAX, or SUM</li>
                            <li>Example: <code>/api/stats</code></li>
                        </ul>
                    </li>
                    <li><strong>Endpoint 3: Search</strong>
                        <ul style="margin-top: 8px;">
                            <li>Accept search query parameter</li>
                            <li>Use LIKE/ILIKE for pattern matching</li>
                            <li>Example: <code>/api/search?q=keyword</code></li>
                        </ul>
                    </li>
                </ol>
            </div>
        </div>

        <!-- Slide 32: Part 3 - EXPLAIN Analysis -->
        <div class="slide">
            <h1>Part 3: Query Performance Analysis</h1>
            <h2>20 Points</h2>

            <div class="activity-box">
                <h3>Task:</h3>
                <p style="font-size: 1.15em;">Analyze the performance of your <strong>most complex query</strong> from Part 1 using EXPLAIN.</p>
            </div>

            <div class="demo-box">
                <h3>Requirements:</h3>
                <ol style="font-size: 1.05em; line-height: 1.8;">
                    <li><strong>Run EXPLAIN:</strong>
                        <ul style="margin-top: 8px;">
                            <li>PostgreSQL: <code>EXPLAIN ANALYZE your_query;</code></li>
                            <li>Take screenshot of the output</li>
                        </ul>
                    </li>
                    <li><strong>Write Analysis (150-200 words):</strong>
                        <ul style="margin-top: 8px;">
                            <li>What type of scan is being used? (Seq Scan, Index Scan, etc.)</li>
                            <li>Approximately how many rows are examined?</li>
                            <li>Is the query efficient? Why or why not?</li>
                            <li>Suggest ONE optimization (e.g., add an index, rewrite query, etc.)</li>
                        </ul>
                    </li>
                </ol>
            </div>

            <div class="tip-box">
                <h3>How to Run EXPLAIN on Neon:</h3>
                <ul style="font-size: 1.05em;">
                    <li>Use Neon SQL Editor (in your Neon dashboard)</li>
                    <li>OR connect via <code>psql</code> using your DATABASE_URL</li>
                    <li>Run <code>EXPLAIN ANALYZE</code> before your SELECT query</li>
                </ul>
            </div>
        </div>

        <!-- Slide 33: Frontend Integration (Bonus) -->
        <div class="slide">
            <h1>Bonus: Frontend Integration</h1>
            <h2>+10 Extra Credit Points</h2>

            <div class="netlify-callout">
                <h3>Optional Bonus:</h3>
                <p style="font-size: 1.15em;">Update your HTML frontend to use at least 2 of your new API endpoints.</p>
            </div>

            <div class="demo-box">
                <h3>Implementation Ideas:</h3>
                <ul style="font-size: 1.05em; line-height: 1.8;">
                    <li><strong>Filter dropdown:</strong> Let users filter by category</li>
                    <li><strong>Sort buttons:</strong> "Sort by Name" / "Sort by Date" buttons</li>
                    <li><strong>Search box:</strong> Real-time search as user types</li>
                    <li><strong>Dashboard cards:</strong> Display stats in styled cards</li>
                    <li><strong>Category breakdown:</strong> Show counts by category</li>
                </ul>
            </div>

            <div class="tip-box">
                <h3>To Earn Bonus Points:</h3>
                <p>Your live Netlify site must demonstrate the frontend using your new APIs. Include screenshots in your submission showing the features in action!</p>
            </div>
        </div>

        <!-- Slide 34: Submission Requirements -->
        <div class="slide">
            <h1>Submission Requirements <span class="emoji">‚úÖ</span></h1>

            <div class="demo-box">
                <h3>What to Submit:</h3>
                <ol style="font-size: 1.15em; line-height: 1.8;">
                    <li><strong>Live Netlify URL</strong>
                        <ul style="margin-top: 8px;">
                            <li>Your deployed site with working API endpoints</li>
                            <li>Test all 3 endpoints are accessible</li>
                        </ul>
                    </li>
                    <li><strong>GitHub Repository</strong>
                        <ul style="margin-top: 8px;">
                            <li>Must include <code>homework_queries.sql</code></li>
                            <li>Must include new API function files</li>
                            <li>Submit commit URL to D2L</li>
                        </ul>
                    </li>
                    <li><strong>README.md or Homework Document</strong>
                        <ul style="margin-top: 8px;">
                            <li>Part 3 EXPLAIN screenshot + analysis</li>
                            <li>API endpoint URLs for testing</li>
                            <li>Brief description of each endpoint</li>
                        </ul>
                    </li>
                </ol>
            </div>

            <div class="demo-box" style="margin-top: 20px;">
                <h3>Grading Rubric:</h3>
                <table class="table-schema" style="font-size: 0.95em;">
                    <tr>
                        <th>Component</th>
                        <th>Points</th>
                        <th>Criteria</th>
                    </tr>
                    <tr>
                        <td><strong>Part 1: Queries</strong></td>
                        <td>40</td>
                        <td>All 5 query types present (8 pts each)</td>
                    </tr>
                    <tr>
                        <td><strong>Part 2: APIs</strong></td>
                        <td>40</td>
                        <td>3 working endpoints, proper error handling</td>
                    </tr>
                    <tr>
                        <td><strong>Part 3: Analysis</strong></td>
                        <td>20</td>
                        <td>EXPLAIN screenshot (10), Analysis quality (10)</td>
                    </tr>
                    <tr>
                        <td><strong>Bonus: Frontend</strong></td>
                        <td>+10</td>
                        <td>Working UI using 2+ new endpoints</td>
                    </tr>
                </table>
            </div>

            <div class="tip-box" style="margin-top: 20px;">
                <h3>Due: Before Next Week's Class</h3>
                <p>Submit to D2L: Live Netlify URL + GitHub commit URL</p>
            </div>
        </div>

        <!-- Slide 35: Practice Problems -->
        <div class="slide">
            <h1>Additional Practice Problems</h1>
            <h2>Optional Extra Practice with movie_rental_db</h2>
            <div class="activity-box">
                <p><strong>For additional practice (not graded):</strong></p>

                <h3>Write SQL queries for movie_rental_db:</h3>
                <ol>
                    <li>List all movies released between 1990 and 2000</li>
                    <li>Count how many movies are in each genre</li>
                    <li>Find the oldest and newest movie in the database</li>
                    <li>Show genres with more than 5 movies (use HAVING)</li>
                    <li>List members whose email ends with '.edu'</li>
                    <li>Find movies whose titles start with 'The'</li>
                    <li>Calculate average release year by genre</li>
                    <li>Show the top 5 most recently added members</li>
                </ol>

                <p><strong>Bonus:</strong> Write a query using a subquery (preview of next week)</p>
            </div>

            <div class="bridge-box" style="margin-top: 20px;">
                <h4>Apply to YOUR Project:</h4>
                <p>Adapt these challenge patterns to your own database schema for even more practice!</p>
            </div>
        </div>

        <!-- Slide 23: Key Takeaways -->
        <div class="slide">
            <h1>Key Takeaways</h1>
            <h2>What You Should Remember</h2>
            
            <div class="highlight-box">
                <h3>‚ú® Essential SQL Concepts</h3>
                <ul>
                    <li>SQL is declarative - you specify WHAT you want, not HOW to get it</li>
                    <li>SELECT and FROM are the only mandatory clauses</li>
                    <li>Clause order matters: SELECT ‚Üí FROM ‚Üí WHERE ‚Üí GROUP BY ‚Üí HAVING ‚Üí ORDER BY</li>
                    <li>WHERE filters rows, HAVING filters groups</li>
                    <li>Aggregate functions operate on sets of rows</li>
                    <li>Pattern matching with LIKE provides flexible searching</li>
                    <li>Good formatting makes queries readable and maintainable</li>
                </ul>
            </div>
            
            <h3>üéØ You Can Now:</h3>
            <ul>
                <li>Write basic to intermediate SELECT statements</li>
                <li>Filter and sort query results</li>
                <li>Use aggregate functions for calculations</li>
                <li>Group data and filter groups</li>
                <li>Apply pattern matching in queries</li>
            </ul>
        </div>

        <!-- Slide 24: Resources -->
        <div class="slide">
            <h1>Resources & Next Steps</h1>
            <h2>Continue Your SQL Journey</h2>
            
            <h3>üìö Recommended Reading</h3>
            <ul>
                <li>Textbook: Chapter 6 (SQL Data Manipulation)</li>
                <li>SQL Tutorial: w3schools.com/sql</li>
                <li>Practice: SQLZoo, HackerRank SQL challenges</li>
            </ul>
            
            <h3>üéØ Before Next Class</h3>
            <ul>
                <li>Complete homework queries</li>
                <li>Review today's examples</li>
                <li>Try variations of the queries we wrote</li>
                <li>Read Chapter 7 preview (Joins and Subqueries)</li>
            </ul>
            
            <h3>üí° Next Lecture: SQL Part 2</h3>
            <ul>
                <li>Multi-table queries (JOINs)</li>
                <li>Subqueries and nested SELECT</li>
                <li>Set operations (UNION, INTERSECT, EXCEPT)</li>
                <li>Advanced filtering techniques</li>
            </ul>
        </div>

        <!-- Slide 25: Questions -->
        <div class="slide">
            <h1>Questions & Discussion</h1>
            <h2>Let's Clarify Any Doubts</h2>
            
            <div style="text-align: center; margin-top: 50px;">
                <h3>ü§î Common Questions from Students:</h3>
                <ul style="text-align: left; display: inline-block;">
                    <li>When should I use WHERE vs HAVING?</li>
                    <li>Can I use multiple aggregate functions?</li>
                    <li>How do I handle NULL values?</li>
                    <li>What's the difference between = and LIKE?</li>
                    <li>How do I optimize slow queries?</li>
                </ul>
            </div>
            
            <div style="margin-top: 50px; text-align: center;">
                <p><strong>Office Hours:</strong> Tuesday & Thursday, 2-4 PM</p>
                <p><strong>Email:</strong> bobby.reed@okcu.edu</p>
                <p><strong>Course Forum:</strong> Post questions anytime!</p>
            </div>
        </div>

        <!-- Navigation Controls -->
        <div class="navigation">
            <button id="prevBtn">Previous</button>
            <span class="slide-counter">
                <span id="currentSlide">1</span> / <span id="totalSlides">44</span>
            </span>
            <button id="nextBtn">Next</button>
        </div>
    </div>

    <!-- Shared Presentation JavaScript -->
    <script src="../../js/presentation.js"></script>

    <!-- Lecture-Specific JavaScript -->
    <script>
        // SQL Part 1 specific interactions
        document.addEventListener('slidechange', (e) => {
            console.log(`Slide ${e.detail.currentSlide + 1} of ${e.detail.totalSlides}`);
        });
    </script>
</body>
</html>